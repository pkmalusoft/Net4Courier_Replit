@page "/gl/setup-guide"
@inject NavigationManager Navigation
@inject ISnackbar Snackbar

<PageTitle>GL Setup Guide</PageTitle>

<MudContainer MaxWidth="MaxWidth.Large" Class="mt-4">
    <MudPaper Class="pa-6" Elevation="2">
        <MudText Typo="Typo.h4" Class="mb-2">General Ledger Setup Guide</MudText>
        <MudText Typo="Typo.body1" Color="Color.Secondary" Class="mb-6">
            Follow these steps to configure your General Ledger module. Complete each section to ensure proper financial tracking.
        </MudText>

        <MudTimeline TimelineOrientation="TimelineOrientation.Vertical" TimelinePosition="TimelinePosition.Start">
            <MudTimelineItem Color="@GetStepColor(0)" Variant="Variant.Filled">
                <ItemOpposite>
                    <MudText Typo="Typo.subtitle2" Color="Color.Secondary">Step 1</MudText>
                </ItemOpposite>
                <ItemContent>
                    <MudCard Elevation="2">
                        <MudCardContent>
                            <MudText Typo="Typo.h6">Configure GL Profile</MudText>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                Set up your account code structure, fiscal year settings, and posting rules.
                            </MudText>
                            <MudChip T="string" Color="@GetStepColor(0)" Size="Size.Small">@GetStepStatus(0)</MudChip>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Variant="Variant.Text" Color="Color.Primary" Href="/gl/profile">Configure</MudButton>
                        </MudCardActions>
                    </MudCard>
                </ItemContent>
            </MudTimelineItem>

            <MudTimelineItem Color="@GetStepColor(1)" Variant="Variant.Filled">
                <ItemOpposite>
                    <MudText Typo="Typo.subtitle2" Color="Color.Secondary">Step 2</MudText>
                </ItemOpposite>
                <ItemContent>
                    <MudCard Elevation="2">
                        <MudCardContent>
                            <MudText Typo="Typo.h6">Set Up Chart of Accounts</MudText>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                Create your account hierarchy with assets, liabilities, equity, income, and expense accounts.
                            </MudText>
                            <MudChip T="string" Color="@GetStepColor(1)" Size="Size.Small">@GetStepStatus(1)</MudChip>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Variant="Variant.Text" Color="Color.Primary" Href="/gl/chart-of-accounts">Set Up</MudButton>
                        </MudCardActions>
                    </MudCard>
                </ItemContent>
            </MudTimelineItem>

            <MudTimelineItem Color="@GetStepColor(2)" Variant="Variant.Filled">
                <ItemOpposite>
                    <MudText Typo="Typo.subtitle2" Color="Color.Secondary">Step 3</MudText>
                </ItemOpposite>
                <ItemContent>
                    <MudCard Elevation="2">
                        <MudCardContent>
                            <MudText Typo="Typo.h6">Configure Control Accounts</MudText>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                Map system accounts for AR, AP, inventory, and other sub-ledger integrations.
                            </MudText>
                            <MudChip T="string" Color="@GetStepColor(2)" Size="Size.Small">@GetStepStatus(2)</MudChip>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Variant="Variant.Text" Color="Color.Primary" Href="/gl/control-accounts">Configure</MudButton>
                        </MudCardActions>
                    </MudCard>
                </ItemContent>
            </MudTimelineItem>

            <MudTimelineItem Color="@GetStepColor(3)" Variant="Variant.Filled">
                <ItemOpposite>
                    <MudText Typo="Typo.subtitle2" Color="Color.Secondary">Step 4</MudText>
                </ItemOpposite>
                <ItemContent>
                    <MudCard Elevation="2">
                        <MudCardContent>
                            <MudText Typo="Typo.h6">Create Financial Periods</MudText>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                Set up your fiscal years and monthly/quarterly periods for transaction control.
                            </MudText>
                            <MudChip T="string" Color="@GetStepColor(3)" Size="Size.Small">@GetStepStatus(3)</MudChip>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Variant="Variant.Text" Color="Color.Primary" Href="/gl/financial-periods">Create</MudButton>
                        </MudCardActions>
                    </MudCard>
                </ItemContent>
            </MudTimelineItem>

            <MudTimelineItem Color="@GetStepColor(4)" Variant="Variant.Filled">
                <ItemOpposite>
                    <MudText Typo="Typo.subtitle2" Color="Color.Secondary">Step 5</MudText>
                </ItemOpposite>
                <ItemContent>
                    <MudCard Elevation="2">
                        <MudCardContent>
                            <MudText Typo="Typo.h6">Enter Opening Balances</MudText>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                Import or manually enter opening balances for all accounts, customers, and suppliers.
                            </MudText>
                            <MudChip T="string" Color="@GetStepColor(4)" Size="Size.Small">@GetStepStatus(4)</MudChip>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Variant="Variant.Text" Color="Color.Primary" Href="/gl/opening-balances">Enter</MudButton>
                        </MudCardActions>
                    </MudCard>
                </ItemContent>
            </MudTimelineItem>

            <MudTimelineItem Color="@GetStepColor(5)" Variant="Variant.Filled">
                <ItemOpposite>
                    <MudText Typo="Typo.subtitle2" Color="Color.Secondary">Step 6</MudText>
                </ItemOpposite>
                <ItemContent>
                    <MudCard Elevation="2">
                        <MudCardContent>
                            <MudText Typo="Typo.h6">Set Up Bank Accounts</MudText>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                Configure bank accounts for cash management and reconciliation.
                            </MudText>
                            <MudChip T="string" Color="@GetStepColor(5)" Size="Size.Small">@GetStepStatus(5)</MudChip>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Variant="Variant.Text" Color="Color.Primary" Href="/bank-accounts">Set Up</MudButton>
                        </MudCardActions>
                    </MudCard>
                </ItemContent>
            </MudTimelineItem>

            <MudTimelineItem Color="@GetStepColor(6)" Variant="Variant.Filled">
                <ItemOpposite>
                    <MudText Typo="Typo.subtitle2" Color="Color.Secondary">Step 7</MudText>
                </ItemOpposite>
                <ItemContent>
                    <MudCard Elevation="2">
                        <MudCardContent>
                            <MudText Typo="Typo.h6">Review and Go Live</MudText>
                            <MudText Typo="Typo.body2" Class="mb-2">
                                Verify your setup, run a trial balance, and mark the system as ready for production use.
                            </MudText>
                            <MudChip T="string" Color="@GetStepColor(6)" Size="Size.Small">@GetStepStatus(6)</MudChip>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Variant="Variant.Text" Color="Color.Primary" OnClick="CompleteSetup">Complete Setup</MudButton>
                        </MudCardActions>
                    </MudCard>
                </ItemContent>
            </MudTimelineItem>
        </MudTimeline>

        <MudDivider Class="my-4" />

        <MudAlert Severity="Severity.Info">
            <MudText Typo="Typo.body2">
                <strong>Need help?</strong> Visit our <MudLink Href="/gl/knowledge-base">Knowledge Base</MudLink> for detailed guides and best practices.
            </MudText>
        </MudAlert>
    </MudPaper>
</MudContainer>

@code {
    private int[] completedSteps = { };

    private Color GetStepColor(int step)
    {
        if (completedSteps.Contains(step)) return Color.Success;
        return Color.Primary;
    }

    private string GetStepStatus(int step)
    {
        if (completedSteps.Contains(step)) return "Completed";
        return "Pending";
    }

    private void CompleteSetup()
    {
        Snackbar.Add("GL Setup completed! You can now start using the General Ledger module.", Severity.Success);
        Navigation.NavigateTo("/gl/journal-entry");
    }
}
