@model Net4Courier.Models.CustomerInvoiceVM

@{
    ViewBag.Title = "Print";
    ViewBag.pTitle = "Customer Invoice";
    ViewBag.pageTitle = "Account Receivable";
    Layout = "~/Views/Shared/_Layout.cshtml";
    int i = 0;
    var _decimal = @Session["Decimal"].ToString();
}
<script>
    $(document).ready(function () {
        $('#btnEmail').click(function () {

            $.ajax({
                type: "Get",
                url: '/Email/GetEmailTemplateDetail/',
                data: {
                    'EmailType': 'Customer Invoice'
                },
                success: function (response) {
                    console.log(response);
                    if (response.Status == 'OK') {
                        var data = response.data;
                        $('#txtRecipientName').val($('#hdnCustomerName').val());
                        $('#txtRecipient').val($('#hdnEmailId').val());
                        $('#txtSubject').val(data.EmailSubject);
                        $('#txtEmailBody').val(data.Content);
                        $('#txtEmailThanks').val(data.RegardsBy);
                        $('#emailpopup').modal('show');
                    }

                }
            });

        })
    })


    function SendEmail() {
        if ($('#txtRecipientName').val() == '') {
            Swal.fire('Data Validation', 'Enter Recipient Name!', 'error');
            $('#txtRecipientName').focus();
            return false;
        }
        if ($('#txtRecipient').val() == '') {
            Swal.fire('Data Validation', 'Enter Recipient Email!', 'error');
            $('#txtRecipient').focus();
            return false;
        }
        else if ($('#txtSubject').val() == '') {
            Swal.fire('Data Validation', 'Enter Subject!', 'error');
            $('#txtSubject').focus();
            return false;
        }
        else if ($('#txtEmailBody').val() == '') {
            Swal.fire('Data Validation', 'Enter Email Body Text!', 'error');
            $('#txtEmailBody').focus();
            return false;
        }

        $.ajax({
            type: "POST",
            url: '/Email/SendEmail/',
            data: {
                EmailType: 'Customer Invoice', 'to': $('#txtRecipient').val(), 'customername': $('#txtRecipientName').val(), 'subject': $('#txtSubject').val(), 'body': $('#txtEmailBody').val(), regards: $('#txtEmailThanks').val(), FileName: $('#iframe1').attr('src')
            },
            success: function (response) {
                Swal.fire('Save Status', response.Message, 'success');
            }
        });
    }
</script>
<div class="card">
    <div class="card-body">
        <div class="row" style="padding-top:10px">
            <div class="text-md-end" style="text-align:right;padding:10px">
                <a id="btnEmail" class="btn btn-primary">Send Email</a>
                <input type="hidden" id="hdnEmailId" value="@ViewBag.CustomerEmailId" />
                <input type="hidden" id="hdnCustomerName" value="@ViewBag.CustomerName" />

                @Html.ActionLink("Cancel", "Index", null, new { @class = "btn btn-secondary btnwidth" })
            </div>
        </div>
        <div class="row" style="padding-top:10px" id="divreportframe">
            @{ Html.RenderAction("ReportFrame", "Reports");}
        </div>
    </div>

</div>
@Html.Partial("~/Views/Shared/_EmailPopup.cshtml")