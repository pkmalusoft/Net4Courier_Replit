@model Net4Courier.Models.ImportShipmentSearch
@{
    //Layout = null;
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Index";
    var isadd = true;
    var ismodify = true;
    var isdelete = true;

    string path = "/ImportShipment/Index";

    if (Convert.ToInt32(Session["UserRoleID"]) > 1)
    {
        Net4Courier.Models.SourceMastersModel obj = new Net4Courier.Models.SourceMastersModel();
        isadd = obj.GetAddpermission(Convert.ToInt32(Session["UserRoleID"]), path);
        ismodify = obj.GetModifypermission(Convert.ToInt32(Session["UserRoleID"]), path);
        isdelete = obj.GetDeletepermission(Convert.ToInt32(Session["UserRoleID"]), path);

    }
}
<script src="~/Content/NewCSS/plugins/jQuery/moment.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.43/js/bootstrap-datetimepicker.min.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.43/css/bootstrap-datetimepicker.min.css" />
<style>
    tfoot {
        display: table-header-group;
    }
    .tblfont td {
        word-break: break-all;
    }
</style>
<script type="text/javascript">


    //$(function () {
    //    $('#FromDate').datetimepicker({ format: 'DD-MM-YYYY' });

    //});

    //$(function () {
    //    $('#ToDate').datetimepicker({ format: 'DD-MM-YYYY' });

    //    $('#ToDate').datepicker("setDate", new Date());
    //});

    //$(function () {
    //    $('#txtpickuptime').datetimepicker({ format: 'DD-MM-YYYY HH:mm' });
    //});

    var table = $('#datatable-1').DataTable();

</script>
<script type="text/javascript">
    $(document).ready(function () {
        var startdate = '@Session["FyearFrom"].ToString()';
        var enddate = '@Session["FyearTo"].ToString()';
        var sd = new Date(startdate.split('-')[1] + '-' + startdate.split('-')[0] + '-' + startdate.split('-')[2]);
        var ed = new Date(enddate.split('-')[1] + '-' + enddate.split('-')[0] + '-' + enddate.split('-')[2]);

        $(function () {
            $('#FromDate').datetimepicker({
                maxDate: ed,
                minDate: sd,
                format: 'DD-MM-YYYY',
            });

        });

        $(function () {
            $('#ToDate').datetimepicker({
                maxDate: ed,
                minDate: sd,
                format: 'DD-MM-YYYY',
            });

            $('#ToDate').datepicker("setDate", new Date());
        });

        $(function () {
            $('#txtpickuptime').datetimepicker({
                maxDate: ed,
                minDate: sd,
                format: 'DD-MM-YYYY HH:mm',
            });
        });
        $('#dataTables-example tfoot th').each(function () {
            var title = $(this).text();
            $(this).html('<input type="text" style=width:100% />');
        });


        var table = $('#dataTables-example').DataTable({ "aaSorting": [], "sPaginationType": "full_numbers" });

        table.columns().every(function () {
            var that = this;

            $('input', this.footer()).on('keyup change', function () {
                if (that.search() !== this.value) {
                    that
                        .search(this.value)
                        .draw();
                }
            });
        });
    });



</script>

<section class="content-header" style="margin-bottom:20px">
    <h1 class="headingfont">Inter-Branch Import</h1>
    @if (TempData["SuccessMsg"] != null)
    {
        <script type="text/javascript">
                  $(document).ready(function () {
                      $.notify("@TempData["SuccessMsg"]", "success");
                 });
        </script>
    }
    @if (TempData["ErrorMsg"] != null)
    {
        <script type="text/javascript">
                  $(document).ready(function () {
                      $.notify("@TempData["ErrorMsg"]", "error");
                 });
        </script>
    }
</section>
@using (Html.BeginForm("Index", "ImportShipment", FormMethod.Post, new { @id = "booksearch" }))
{

    @Html.AntiForgeryToken()

    <div class="row d-flex">

        <div class="col-md-1">
            <label class="headinglabel">From Date</label>
            @Html.TextBoxFor(model => model.FromDate, new { @class = "form-control text-right" })
        </div>

        <div class="col-md-1">
            <label class="headinglabel">To Date</label>
            @Html.TextBoxFor(model => model.ToDate, new { @class = "form-control text-right" })
        </div>
        <div class="col-md-1 m-top col-sm-3  m-top">
            @*<input type="submit" value="Filter" class="btn btn-primary btn-gradient btn-block waves-effect waves-light" />*@
            <button type="submit" class="btn btn-success" style="min-width:50px!Important;"><i class="fa fa-refresh" aria-hidden="true"></i></button>
        </div>

        <div class="m-top filter_btns text-md-right text-right m-top" style="margin-bottom:10px;">
            @*@if (ViewBag.Token.Create)
                {
                    @Html.ActionLink("Create", "Create", null, new { @class = "btn btn-primary btn-sm waves-effect waves-light" });
                }*@
            @if (@Net4Courier.Models.CommonFunctions.CheckCreateEntryValid() == false || (!isadd))
            {
                @Html.ActionLink("Create New", "Create", null, new { @class = "btn btn-primary btn-sm waves-effect waves-light", @disabled = "disabled" })
            }
            else
            {
                @Html.ActionLink("Create New", "Create", null, new { @class = "btn btn-primary btn-sm waves-effect waves-light" })
            }
            @*@Html.ActionLink("View Imports", "ViewImport", null, new { @class = "btn btn-primary btn-sm waves-effect waves-light" })

                <button type="button" style="margin-left:25px" class="btn btn-primary btn-sm waves-effect waves-light" onclick="printDiv()">Summary</button>*@
        </div>
    </div>
}
<div class="table-responsive tblbackground" style="padding:15px">
    <table class="table table-responsive table-bordered tblfont" id="dataTables-example">
        <thead>
            <tr>
                <th>
                    @Html.Label("Manifest Number")
                </th>
                <th>
                    @Html.Label("Manifest Date")
                </th>
                <th>
                    @Html.Label("Agent Name")
                </th>
                <th>Ref AWB</th>
                <th>Action</th>
            </tr>
        </thead>
        <tfoot>
            <tr>
                <th>
                    @Html.Label("Manifest Number")
                </th>
                <th>
                    @Html.Label("Manifest Date")
                </th>
                <th>
                    @Html.Label("AgentName")
                </th>
                <th>Ref AWB</th>

                

                <th style="display:none"></th>
            </tr>
        </tfoot>

        @foreach (var item in Model.Details)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.ManifestNumber)
                </td>
                <td>
                    @Net4Courier.Models.CommonFunctions.GetShortDateFormat(@item.CreatedDate)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.AgentName)
                </td>
                <td>
                    <span style="text-wrap:initial">
                        @Html.DisplayFor(modelItem => item.AWBNumbers)
                    </span>
                </td>
                <td>
                    <a href="@Url.Action("Create", new { id = item.ID })"><i class="fa fa-pencil"></i></a> |

                    <a href="#" onclick="Delete(ID=@item.ID)"><i class="fa fa-times"></i></a>
                    <a class="aprint" target="_blank" href="ImportShipmentPrint?id=@item.ID" title="Import Shipment Printing"><i class="fa fa-print"></i></a>
                    @*<a href="@Url.Action("ExportShipmentReport", new { id = item.ID })"><i class="fa fa-print"></i></a> |*@
                </td>
            </tr>
        }

    </table>
</div>
<script>
        $(document).ready(function () {
            $("#importshipment").addClass("active");
            @if(TempData["toasterMessage"] != null)
            {
                @:toasterMessage("@TempData["toasterMessage"].ToString()");
            }
        });

    function Delete(ID) {
        if (confirm("Are you sure, You want to Delete Import Manifest?")) {
            window.location.href = "/ImportShipment/Delete/?id=" + ID;
        }
    }
    function deleteExport(id, controller) {
        if (confirm("Are you sure, You want to Delete this Import Manifest Entry ?")) {
            window.location.href = "/ImportShipment/Delete?id=" + id;
        }
            //debugger;
            //swal({
            //    title: "Are you sure?",
            //    text: "You will not be able to recover this " + controller,
            //    type: "warning",
            //    showCancelButton: true,
            //    confirmButtonClass: "btn-danger",
            //    confirmButtonText: "Yes, delete it!",
            //    cancelButtonText: "No, cancel plx!",
            //    closeOnConfirm: false,
            //    closeOnCancel: false
            //},
            //    function (isConfirm) {
            //        if (isConfirm) {
            //            $.ajax({
            //                type: "POST",
            //                datatype: "html",
            //                url: "Delete?id=" + id.toString(),
            //                data: id,
            //                success: function (data) {
            //                    debugger;
            //                    swal({ title: "Deleted!", text: controller + " has been deleted.", type: "success" }, function () { window.location = window.location.href; });
            //                }
            //            });
            //        } else {
            //            swal("Cancelled", controller + " is safe :)", "error");
            //        }
            //    });

        }
</script>

