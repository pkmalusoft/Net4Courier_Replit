@model Net4Courier.Models.MenuVM

@{
    ViewBag.Title = "Edit";
    ViewBag.pTitle = "Menu Creation";
    ViewBag.pageTitle = "Menu Creation";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<script type="text/javascript">
    $(document).ready(function () {
        $("#Title").focus();
        $(":text").css({ "border-radius": "5px" });
        $("select").css({ "border-radius": "5px" });

        $(".parent").find('ul').css('display', 'none');
        $("ul").css('list-style-type', 'disc');
       

        $("a.menutrv").click(function () {
            $("a.menutrv").removeClass("selected");
            $("#ParentID").val($(this).attr('itemid'));
            $(this).addClass("selected");


        });

        $('.parent').click(function () {

            //$(this).find('ul').slideToggle();
            $(this).children("ul").slideToggle();
        });

        $("#btnsave").click(function () {
            var title = $("#Title").val();




            if (title == "") {
                $("#alert").show();
                return false;
            }


            else {
                $("#alert").hide();
                return true;
            }


        });



    });
</script>

<style>
    .selected {
        display: block;
        background-color: #556ee6;
        color: #fff !important;
    }
    .parent a{
        color: black;
    }
    .parent{
        padding: 5px;
        cursor: pointer;
    }
    .menutrv{
        height: 31px;
        padding-left: 10px;
        border-radius: 5px;
        padding-top: 6px;
    }
    
</style>

  <div class="card">
        <div class="card-body">
    @using (Html.BeginForm())
    {
        @Html.ValidationSummary(true)
          <div id="alert" style="color:red;display:none;margin-left:10px;">*Please fill mandatory fields</div>
        <fieldset>
         
            <div class="row no-margin"> 
                <div class="col-md-3">
                    <label class="required headinglabel">Menu Title</label>
                    @Html.HiddenFor(model => model.MenuID)
                    @Html.TextBoxFor(model => model.Title, new { @class = "form-control txttarget" })
                    @Html.ValidationMessageFor(model => model.Title)
                    @Html.HiddenFor(model => model.ParentID)
                </div>

                <div class="col-md-3">
                    <label class="headinglabel">Navigation Link</label>
                    @Html.TextBoxFor(model => model.Link, new { @class = "form-control" })
                    @Html.ValidationMessageFor(model => model.Link)
                </div>

                    <div class="col-md-3">
                    <label class="headinglabel">Order</label>
                    @Html.TextBoxFor(model => model.MenuOrder, new { @class = "form-control" })
                    @Html.ValidationMessageFor(model => model.MenuOrder)
                </div>
              
                 <div class="col-md-3 text-md-end btn_top">
                    <input type="submit" value="Update" class="btn btn-success btnwidth" id="btnsave" />
                    <a href='@Url.Action("Index", "MenuCreation", new { id = 0 })' class="btn btn-secondary btnwidth">Cancel</a>

                
            </div>
            </div>

           <div class="row no-margin mt-4">      
               <div class="col-md-3">
                   <label class="headinglabel">Parent</label>
                  <ul class="treeview-menu mt-4">


                       @{
        List<Net4Courier.Models.Menu> menuList = (List<Net4Courier.Models.Menu>)Session["Menu"];
        List<Net4Courier.Models.Menu> parentMenu = new List<Net4Courier.Models.Menu>();
        if (menuList != null)
        {

            parentMenu = menuList.Where(p => Convert.ToInt32(p.ParentID) == 0).ToList();
        }
                           <ul>
                               @if (parentMenu != null)
                               {


                                   foreach (var item in parentMenu)
                                   {
                                   <li class="parent"><a itemid=@item.MenuID  class="menutrv">@item.Title</a>
                                       @if (menuList.Count(p => p.ParentID == item.MenuID) > 0)
                                       {
                                           @:<ul>

                                       }
                                       @RenderMenuList(menuList, item)
                             @if (menuList.Count(p => p.ParentID == item.MenuID) > 0)
                             {
                              @:</ul>
                                                                                                                                                                                                                                                       
                             }
                                   </li>
                            
                                   }
                               }
                           </ul>
                           @helper RenderMenuList(List<Net4Courier.Models.Menu> menuList, Net4Courier.Models.Menu mi)
{
    foreach (var item1 in menuList.Where(p => p.ParentID == mi.MenuID))
    {
                               @:<li class="parent">
<a itemid=
@item1.MenuID class="menutrv">@item1.Title</a>
        if (menuList.Count(p => p.ParentID == item1.MenuID) > 0)
        {
                               @:<ul>
                                           }
                               @RenderMenuList(menuList, item1)
        if (menuList.Count(p => p.ParentID == item1.MenuID) > 0)
        {
                               @:</ul>
                                           }
        else
        {
                               @:</li>   
                                           }
    }
                           }
                                   
                       }

                   </ul>
               </div>
                <div class="col-md-3 checkboxdesign" style="padding-top:15px">

                    @Html.CheckBox("PermissionRequired", new { @name = "PermissionRequired" }) 
                    <label class="headinglabel">Permission Required</label>
                </div>

                 <div class="col-md-2 checkboxdesign" style="padding-top:15px">
                     @Html.CheckBox("Active", new { @name = "Active" }) 
                    <label class="headinglabel">Is Active</label>
                </div>
					<div class="col-md-2 checkboxdesign" style="padding-top:15px">
                 
                    @Html.CheckBox("IsAccountMenu", new {@name = "IsAccountMenu" })
                      @Html.ValidationMessageFor(model => model.IsAccountMenu)
						     <label class="headinglabel">Is AccountMenu</label>
                </div>

            </div>

             <div class="row no-margin" style="padding-top: 10px">
                  
            </div>

          

        </fieldset>
       
    }

</div>
</div>
