@model Net4Courier.Models.YearEndProcessSearch
    @{
        var i = 0;
    }
    
<script type="text/javascript">

    function showcustomerstatement(customerid) {
        $.ajax({
            //contentType: 'application/json;charset=utf-8',
            type: "POST",
            dataType: 'html',
            url: "/Accounts/ShowYearEndCustomerStatement",
            data: {
                'CustomerType': $('#CustomerType').val(), 'CustomerId':customerid
            },
            success: function (response1) {
                $('#customerlistContainer').html(response1);
                var customername = $('#hdncustomerName_0').val();
                $('#CustomerStatementModalLabel').html('Statement of ' + customername);
                $('#customerinvpopup').modal('show');
            }
        });
       
    }
    $(document).ready(function () {

        //$('#DetailsTable tfoot th').each(function () {
        //    var title = $(this).text();
        //    $(this).html('<input type="text" style=width:100% />');
        //});

        $("#Selectall").click(function () {
            debugger;
            var idtext = 'hdncustomerchecked_';
            if ($("#Selectall").is(':checked')) {
                $('[id^=' + idtext + ']').each(function (index, item) {
                 

                   
                        $(item).prop('checked', true);
                    


                });
            }
            else {
                debugger;
                $('[id^=' + idtext + ']').each(function (index, item) {
                   

                   
                            $(item).prop('checked', false);
                            $(item).removeAttr('checked');
                       
                    
                });
            }
        });

        var table1 = $('#AcYearEndCustomer').DataTable({ "paging": false, "sPaginationType": "simple" });
        $('#CustomerType1').change(function () {
            $('#CustomerType').val($('#CustomerType1').val());

        })

        $('#CustomerType1').val($('#CustomerType').val()).trigger('change');
        //table1.columns().every(function () {
        //    var that = this;

        //    $('input', this.footer()).on('keyup change', function () {
        //        if (that.search() !== this.value) {
        //            that
        //                .search(this.value)
        //                .draw();
        //        }
        //    });
        //});
    });
</script>
<div class="row">
    <div class="col-md-2">
        <label class="col-form-label required">For Customer Type</label>
        @Html.DropDownList("CustomerType1", new List<SelectListItem>
    {
        new SelectListItem{ Text="Credit Customer", Value = "CR" },
        new SelectListItem{ Text="CO-Loader", Value = "CL" },

     }, new { @class = "form-select" })


    

    </div>
    <div class="col-md-10" style="margin-top:42px">
        <h5> @Model.CurrentYear Customer Invoice Closing Balance </h5>
    </div>
    
</div>
<div class="row no-margin" >
    <div class="col-md-12">
        <table class="table table-responsive table-bordered" id="AcYearEndCustomer" style="background-color:white">
            <thead>
                <tr>
                    <th>
                        S.No
                        <input type="checkbox" style="width:20px;" class="Selectall" id="Selectall" value="1" name="Selectall" />
                    </th>
                    <th>Customer Name</th>
                    @*<th>Invoice No.</th>
                    <th>Invoice Date</th>*@
                    <th>
                        Closing Balance(@Model.CurrentYear)
                    </th>
                    <th>
                        Posted Balance
                    </th>
                    <th>Difference</th>
                    <td>

                    </td>
                </tr>
            </thead>
            <tbody id="details">
                @{ 
                    if (Model.CustomerInvDetails != null)
                    { foreach (var item in Model.CustomerInvDetails)
                        {
                    <tr>
                        <td id="row_@i">
                            @(i + 1)
                            @Html.CheckBoxFor(model => model.CustomerInvDetails[i].Selected, new { @id = "hdncustomerchecked_" + @i, @class = " calfield", style = "heiht:20px;margin-left:10px;", @customerid = item.CustomerId })
                        </td>
                        <td>
                            <a target="_blank" href="/ReceiptPaymentAllocation/Index1?id=@item.CustomerId">@item.CustomerName</a>

                        </td>
                        @*<td>
                    @item.InvoiceNo
                </td>
                <td>
                    @item.InvoiceDate
                </td>*@

                        @if (item.ClosingAmount < 0)
                        {
                            <td style="text-align:right;color:red">
                                (    @Net4Courier.Models.CommonFunctions.GetFormatNumber(-1 * @item.ClosingAmount, "2") )
                            </td>
                        }
                        else
                        {
                            <td style="text-align:right;color:blue">
                                @Net4Courier.Models.CommonFunctions.GetFormatNumber(@item.ClosingAmount, "2")
                            </td>
                        }
                        @if (item.OpeningAmount < 0)
                        {
                            <td style="text-align:right;color:red">
                                ( @Net4Courier.Models.CommonFunctions.GetFormatNumber(-1 * @item.OpeningAmount, "2") )
                            </td>
                        }
                        else
                        {
                            <td style="text-align:right;color:blue">
                                @Net4Courier.Models.CommonFunctions.GetFormatNumber(@item.OpeningAmount, "2")
                            </td>
                        }
                        @if (item.Difference < 0)
                        {
                            <td style="text-align:right;color:red">
                                ( @Net4Courier.Models.CommonFunctions.GetFormatNumber(-1 * @item.Difference, "2") )
                            </td>
                        }
                        else
                        {
                            <td style="text-align:right;color:blue">
                                @Net4Courier.Models.CommonFunctions.GetFormatNumber(@item.Difference, "2")
                            </td>
                        }
                        <td>
                            <a href="javascript:void(0)" onclick="showcustomerstatement(@item.CustomerId)" class="text-success"><i class="mdi mdi-eye font-size-18"></i></a>
                        </td>
                    </tr>
                                i++;
                            }
                        }
                    }
            </tbody>
        </table>
    </div>
</div>


<div class="modal fade" id="customerinvpopup" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="border-radius:5px">
            <div class="modal-header">

                <h5 class="modal-title" id="CustomerStatementModalLabel">
                    Customer Statement of @ViewBag.CustomerName
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row" id="customerlistContainer" style="max-height:400px;overflow-y:scroll">
                   
                </div>
            </div>
            <div class="modal-footer" style="padding-top: 5px">

                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>