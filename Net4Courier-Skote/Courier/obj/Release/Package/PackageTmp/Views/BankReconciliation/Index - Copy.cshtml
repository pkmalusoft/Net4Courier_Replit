@model Net4Courier.Models.BankModal
@using System.Data
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "BankReconciliation";
}

<div class="row" id="DetailReport">
    <div class="col-12">
        <div class="iq-card">
            <div class="iq-card-header d-flex justify-content-between">
                <div class="iq-header-title">
                    <h4 class="card-title">Bank Reconciliation</h4>
                </div>
            </div>
            <div class="iq-card-body">
                @using (@Html.BeginForm("Index", "BankReconciliation", FormMethod.Post, new { @id = "form-bank", @enctype = "multipart/form-data" }))
                {
                    <div class="row">
                        <div class="col-w-18 col-12">
                            <div class="form-group">
                                <label for="FromDate">From Date:</label>
                                <input type="date" class="form-control form-control-sm" id="dtpFrom" name="dtpFrom" value="@Model.dtpFrom" required/>
                            </div>
                        </div>
                        <div class="col-w-18 col-12">
                            <div class="form-group">
                                <label for="ToDate">To Date:</label>
                                <input type="date" class="form-control form-control-sm" id="dtpTo" name="dtpTo" value="@Model.dtpTo" required/>
                            </div>
                        </div>
                        <div class="col-sm-2">
                            <div class="form-group">
                                <label for="Product">Bank:</label>
                                @Html.DropDownList("cboProduct", (List<SelectListItem>)ViewBag.BankList, "Select Bank", new { required = "false", @class = "form-control form-control-sm mb-3" })
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        @if (Model.ResultViewModel.Count == 0)
                        {
                            <div class="col-sm-4 col-6">

                                <div class="custom-file">
                                    <input type="file" class="custom-file-input" name="file-upload" id="file-upload" required>
                                    <label class="custom-file-label" for="fileUpload">Choose file</label>
                                </div>

                            </div>
                            <div class="col-sm-4 col-6">
                                <button type="submit" value="Upload" class="btn btn-sm mr-2 btn-block-mob btn-primary"><i class="las la-upload"></i>Upload</button>
                                <a class="btn btn-sm mr-2 btn-block-mob btn-primary" title="Download Sample" href="@Url.Action("DownloadSampleStatement", "BankReconciliation")" role="button"><i class="las la-download"></i>Download</a>
                            </div>
                        }
                    </div>
                }

                @if (Model.ResultViewModel != null)
                {
                    if (Model.ResultViewModel.Count > 0)
                    {
                        using (@Html.BeginForm("Save", "BankReconciliation", FormMethod.Post, new { @id = "form-bank-save" }))
                        {
                            <div class="form-group row">
                                <div class="col-12">
                                    <div class="table-responsive">
                                        <table class="table table-sm" id="data-table">
                                            <thead>
                                                <tr>
                                                    <th class="text-center" colspan="2">#</th>
                                                    <th class="text-center">Bank Name</th>
                                                    <th class="text-center">Cheque Number</th>
                                                    <th class="text-right">Cheque Amount</th>

                                                    <th class="text-center">Bank Name</th>
                                                    <th class="text-center">Cheque Number</th>
                                                    <th class="text-right">Cheque Amount</th>

                                                    <th class="text-center" colspan="2">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @{int i = 1; int j = 0;}
                                                @foreach (Net4Courier.Models.CsvRecordsViewModel item in Model.ResultViewModel)
                                                {
                                                    <tr class="@(@item.Status == 1 ? "bg-success" : (@item.Status == 0 ? "bg-warning" : "bg-danger"))">
                                                        <td class="accordion-toggle cursor-pointer" data-toggle="collapse" data-target="#accordion-@i">
                                                            <i class="fa fa-chevron-down"></i>
                                                        </td>
                                                        <td class="text-center">@i</td>
                                                        <td class="text-left">@item.BName</td>
                                                        <td class="text-center">@item.ChqNo</td>
                                                        <td class="text-right">@item.ChqAmount</td>

                                                        <td class="text-left">@item.BankName</td>
                                                        <td class="text-center">@item.ChequeNo</td>
                                                        <td class="text-right">@item.ChequeAmount</td>
                                                        <td class="text-right">
                                                            <div class="custom-control custom-switch custom-control-inline">
                                                                @Html.CheckBoxFor(m => m.ResultViewModel[j].IsCleared, new { @id = string.Format("status_{0}", i), @class = "custom-control-input status" })
                                                                <label class="custom-control-label" for="status_@i"></label>
                                                            </div>
                                                            @Html.HiddenFor(m => m.ResultViewModel[j].ChqNo)
                                                            @Html.HiddenFor(m => m.ResultViewModel[j].TransactionID)
                                                            @Html.HiddenFor(m => m.ResultViewModel[j].Status)
                                                            @Html.HiddenFor(m => m.ResultViewModel[j].BName)
                                                            @Html.HiddenFor(m => m.ResultViewModel[j].ChqAmount)
                                                        </td>
                                                        <td class="text-right">
                                                            @Html.DropDownListFor(m => m.ResultViewModel[j].ChqStatus, new SelectList(ViewBag.StatusList, "Value", "Text"), "Select Status", new { id = string.Format("chq-status_{0}", i), @class = "form-control form-control-sm chq-status mb-3" })
                                                            @*@Html.DropDownListFor(m => m.ResultViewModel[j].ChqStatus, (List<SelectListItem>)ViewBag.StatusList, "Select Status", new { id = string.Format("chq-status_{0}", i), @class = "form-control form-control-sm chq-status mb-3" })*@
                                                            <div>
                                                                @Html.TextBoxFor(m => m.ResultViewModel[j].Remarks, new { id = string.Format("remarks_{0}", i), @class = "form-control form-control-sm remarks", placeholder = "remarks" })
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr id="accordion-@i" class="accordion-toggle accordian-body collapse @(@item.Status == 1 ? "bg-success" : (@item.Status == 0 ? "bg-warning" : "bg-danger"))">
                                                        <td colspan="10">
                                                            <div>
                                                                Cheque Date : @item.ChequeDate.ToString("dd-MMM-yyyy") &nbsp; &nbsp;&nbsp;&nbsp;
                                                                Value Date : @item.ValueDate.ToString("dd-MMMM-yyyy") &nbsp;&nbsp;&nbsp;&nbsp;
                                                                Party Name : @item.PartyName
                                                            </div>
                                                        </td>
                                                        @{i++; j++;}
                                                    </tr>
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="row justify-content-center mb-3">
                                <div class="col-4 text-center">
                                    <button type="submit" value="Upload" class="btn btn-sm mr-2 btn-block-mob btn-primary"><i class="las la-save"></i>Save</button>
                                    <button type="button" class="btn btn-sm mr-2 btn-block-mob btn-primary" title="Download PDF" id="btnDownloadPDF"><i class="las la-download"></i>Download </button>
                                    <a class="btn btn-sm mr-2 btn-block-mob btn-primary" title="Cancel" href="@Url.Action("Index", "BankReconciliation")" role="button">Cancel</a>
                                </div>
                            </div>
                        }
                    }
                    else if (Model.ResultViewModel.Count == 0 && !ViewBag.isLoadingFirst)
                    {
                        <div class="row">
                            <div class="col-12">
                                <div class="table-responsive">
                                    <table class="table table-sm table-hover">
                                        <tbody>
                                            <tr>
                                                <td class="text-center" colspan="10">
                                                    <strong>***** NO DATA FOUND*****</strong>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    }
                }

            </div>
        </div>
    </div>
</div>



