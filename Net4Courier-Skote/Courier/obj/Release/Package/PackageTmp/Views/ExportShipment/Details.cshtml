@model Net4Courier.Models.ExportShipmentFormModel
@{
    ViewBag.Title = "View";
    ViewBag.pTitle = "Manage Manifest";
    ViewBag.pageTitle = "Outbound";
    var i = 1;
    Layout = "~/Views/Shared/_Layout.cshtml";
    var _decimal = @Session["Decimal"].ToString();
}


<script type="text/javascript">
    $(document).ready(function () {
        $(":text").css({ "border-radius": "5px" });
        $("select").css({ "border-radius": "5px" });
        setTwoNumberDecimal($('#AdminPer'));
        setTwoNumberDecimal($('#CustomerInvoiceTax'));
        setTwoNumberDecimal($('#FuelPer'));
    });

</script>
<script>
    function ExportExcelNew() {

        var d = new Date();
        var curr_date = d.getDate();
        var curr_month = d.getMonth() + 1;
        var curr_year = d.getFullYear();
        //$('#CustomerInvoiceNo').val();
        var reqdate = $('#hdnMAWB').val() + "_" + curr_date.toString() + curr_month.toString() + curr_year.toString();// + '_' + d.getHours() + d.getMinutes();
        $("#divreportNew").table2excel({
            filename: "Manifest_" + reqdate + ".xls"
        });

        
    }
     function setTwoNumberDecimal(obj) {
        if ($(obj).val() == null || $(obj).val() == "") {
            $(obj).val(0);
        }
        else {

            $(obj).val(parseFloat($(obj).val()).toFixed(@_decimal));
        }
    }
       function printDiv() {
          var divid="divreport"
    var contents = document.getElementById(divid).innerHTML;
    var frame1 = document.createElement('iframe');
    frame1.name = "frame1";
    frame1.style.position = "absolute";
    frame1.style.top = "-1000000px";
    document.body.appendChild(frame1);
    var frameDoc = frame1.contentWindow ? frame1.contentWindow : frame1.contentDocument.document ? frame1.contentDocument.document : frame1.contentDocument;
    frameDoc.document.open();
    frameDoc.document.write('<html><head><title>DIV Contents</title>');
    frameDoc.document.write('</head><body>');
    frameDoc.document.write(contents);
    frameDoc.document.write('</body></html>');
    frameDoc.document.close();
    setTimeout(function () {
        window.frames["frame1"].focus();
        window.frames["frame1"].print();
        document.body.removeChild(frame1);
    }, 500);
    return false;
}

</script>
<div class="row no-margin" style="padding-top: 10px">
    <div class="col-md-12 text-md-end">
        <button type="button" value="" class="btn btn-success" onclick="ExportExcelNew()"><i class="mdi mdi-file-excel font-size-16"></i></button>
        <button type="button" value="Print" class="btn btn-warning" onclick="printDiv()"><i class="mdi mdi-file-pdf font-size-16"></i></button>
        
        <a href='/ExportShipment/CreateExport?id=@Model.ID' class="btn btn-primary">Edit</a>
        @Html.ActionLink("Cancel", "Index", null, new { @class = "btn btn-secondary" })
    </div>
</div>

<div class="" id="divreport">
    <style>
        body {
            box-sizing: border-box;
            font-family: Calibri;
        }



        .invoiceRow {
            margin: 50px 0;
        }

        .logo {
            padding-left: 60px;
            padding-bottom: 20px;
        }

        .invoiceRow table th {
            text-align: left;
            /*background: #daf2fb;*/
            -webkit-print-color-adjust: exact;
            color: #1a7fa5;
            font-size: 14px;
        }

        .headrow {
            justify-content: space-between;
            align-items: flex-end;
        }

        .d-flex {
            display: flex;
        }

        table {
            width: 100%;
        }

        .trnrow {
            display: flex;
            justify-content: flex-end;
        }

        .invoiceRow table {
            /*border: 1px solid #c0e0ec;*/
            
            border-spacing: 0;
            border-collapse: unset;
        }

            .invoiceRow table th, .invoiceRow table td {
                padding: 8px 10px;
            }


        .rightInfo, .leftInfo, .logo, .rightBlock, .trnitem, .rightTotal {
            width: 40%;
        }

        .rightBlock, .trnitem {
            text-align: center;
        }

            .rightBlock h1 {
                text-transform: uppercase;
                color: #a51717;
            }

        .rightInfo table {
            background: #eee;
        }

            .rightInfo table th {
                border-bottom: 2px dashed #333;
            }

            .rightInfo table th, .rightInfo table td {
                border-right: 2px solid #333;
            }

                .rightInfo table th:last-of-type, .rightInfo table td:last-of-type {
                    border-right: none;
                }

        .particularInner table {
            border-spacing: 0;
        }

            .particularInner table th {
                border-top: 2px solid #07a7e3;
                border-bottom: 2px solid #07a7e3;
                padding: 8px 6px;
                text-align: left;
                background: #07a7e3;
                font-size: 14px;
                color: #fff;
                font-weight: normal;
                -webkit-print-color-adjust: exact;
            }

            .particularInner table td {
                padding: 5px 10px;
                font-weight: normal;
            }

        .trnBlock {
            padding-bottom: 30px;
        }

        .particularInner table tr:last-of-type td {
            border-bottom: 2px solid #333;
        }

        .particularInner table > thead > th {
            font-weight: 500;
        }

        .particularInner table > tbody > tr > td {
            font-size: 13px !important;
        }

        .totalRow {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            padding: 10px 0;
        }

            .totalRow h3 {
                padding-bottom: 20px;
                text-decoration: underline;
            }

            .totalRow table {
                font-weight: bold;
                table-layout: fixed;
                text-align: right;
            }

        .terms ol {
            list-style-position: inside;
        }

            .terms ol li {
                padding: 5px 0;
            }

        .text-right {
            text-align: right !important;
        }
        td,th{
            text-align: center !important;
        }
        .btn{
            font-size: 16px;
            padding: 6px 15px;
        }
    </style>
    <div class="card">
        <div class="card-body">
            <input type="hidden" id="hdnMAWB" value="@Model.MAWB" />
            <div id="divreportNew">
                <section class="invoiceInfo">
                    <div class="invoiceRow d-flex">

                        <table class="table table-bordered">
                            <tr>
                                <th></th>
                                <th>MAWB</th>
                                <th><b>@Model.MAWB</b> </th>
                                <th colspan="5" style="text-align:center"><b>MANIFEST </b></th>
                                <th><b>Manifest No.</b></th>
                                <th><b> @Html.DisplayFor(model => model.ManifestNumber)</b></th>
                            </tr>
                            <tr>
                                <th></th>
                                <th></th>
                                <th><b>Shipper</b></th>
                                <th> </th>
                                <th><b>Consignee</b></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th><b>ORIGIN AIRPORT</b></th>
                                <th>@Model.OriginAirportCity</th>
                            </tr>
                            <tr>
                                <th></th>
                                <th></th>
                                <th>
                                    @Html.DisplayFor(model => model.ConsignorName)
                                </th>
                                <th> </th>
                                <th>
                                    @Html.DisplayFor(model => model.ConsigneeName)
                                </th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th><b>Destination Airport</b>	</th>
                                <th>@Model.DestinationAirportCity</th>
                            </tr>
                            <tr>
                                <th></th>
                                <th></th>
                                <th>
                                    @Html.DisplayFor(model => model.ConsignorAddress)
                                </th>
                                <th> </th>
                                <th>
                                    @Html.DisplayFor(model => model.ConsigneeAddress)
                                </th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th>Flight No.</th>
                                <th>@Html.DisplayFor(model => model.FlightNo)</th>
                            </tr>
                            <tr>
                                <th></th>
                                <th></th>
                                <th>
                                    @Html.DisplayFor(model => model.ConsignorAddress2)
                                </th>
                                <th> </th>
                                <th>
                                    @Html.DisplayFor(model => model.ConsigneeAddress2)
                                </th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th>Flight Date</th>
                                <th>  @Html.DisplayFor(model => model.FlightDate)</th>
                            </tr>
                            <tr>
                                <th></th>
                                <th></th>
                                <th>
                                    @Html.DisplayFor(model => model.ConsignorCityName)
                                    @Html.DisplayFor(model => model.ConsignorCountryName)
                                </th>
                                <th> </th>
                                <th>
                                    @Html.DisplayFor(model => model.ConsigneeCityName)
                                    @Html.DisplayFor(model => model.ConsigneeCountryname)
                                </th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th>CD</th>
                                <th> @Html.DisplayFor(model => model.CD)</th>
                            </tr>

                            <tr>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th> </th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th>Bags</th>
                                <th>    @Html.DisplayFor(model => model.Bags)</th>
                            </tr>

                            <tr>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th> </th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th>Run No.</th>
                                <th>   @Html.DisplayFor(model => model.RunNo)</th>
                            </tr>


                            <!--  <tr  >
                            <th>Manifest No.</th>
                            <th>Consignor Name</th>
                            <th>Consignee Name</th>
                            <th>Origin Airport</th>
                            <th>Destination Airport</th>
                            <th>---</th>
                        </tr>
                        <tr>
                            <td>
                                @Html.DisplayFor(model => model.ManifestNumber)
                            </td>
                            <td>
                                @Html.DisplayFor(model => model.ConsignorName)
                                @Html.DisplayFor(model => model.ConsignorAddress)
                                @Html.DisplayFor(model => model.ConsignorAddress2)
                                @Html.DisplayFor(model => model.ConsignorCityName)
                                @Html.DisplayFor(model => model.ConsignorCountryName)
                            </td>
                            <td>
                                @Html.DisplayFor(model => model.ConsigneeName)
                                @Html.DisplayFor(model => model.ConsigneeAddress)
                                @Html.DisplayFor(model => model.ConsigneeAddress2)
                                @Html.DisplayFor(model => model.ConsigneeCityName)
                                @Html.DisplayFor(model => model.ConsigneeCountryname)
                            </td>
                            <td>@Html.DisplayFor(model => model.OriginAirportCity)</td>
                            <td>@Html.DisplayFor(model => model.DestinationAirportCity)</td>
                        </tr>
                        <tr>
                            <th>
                                Origin Country
                            </th>
                            <th>Destination Country</th>
                            <th>Flight Date</th>
                            <th>CD</th>
                            <th>Run No.</th>
                            <th>Bags</th>
                        </tr>
                        <tr>
                            <td>
                                @Html.DisplayFor(model => model.ConsignorCountryName)
                            </td>
                            <td>
                                @Html.DisplayFor(model => model.ConsigneeCountryname)
                            </td>
                            <td>
                                @Html.DisplayFor(model => model.FlightDate)
                            </td>
                            <td>
                                @Html.DisplayFor(model => model.CD)
                            </td>
                            <td>
                                @Html.DisplayFor(model => model.RunNo)
                            </td>
                            <td>
                                @Html.DisplayFor(model => model.Bags)
                            </td>
                        </tr>
                        <tr>
                            <th>Consignor Address</th>
                            <th>Consignee Address</th>
                            <th>Flight No.</th>
                            <th>Type</th>
                            <th>
                                MAX AWB
                            </th>
                            <th>
                                Total AWB
                            </th>
                        </tr>
                        <tr>
                            <td>  @Html.DisplayFor(model => model.ConsignorAddress)</td>
                            <td>    @Html.DisplayFor(model => model.ConsigneeAddress)</td>
                            <td>
                                @Html.DisplayFor(model => model.FlightNo)
                            </td>
                            <td>
                                @Html.DisplayFor(model => model.Type)
                            </td>
                            <td>
                                @Html.DisplayFor(model => model.MAWB)
                            </td>
                            <td>
                                @Html.DisplayFor(model => model.TotalAWB)
                            </td>
                        </tr>-->
                        </table>

                    </div>
                </section>
                <section class="particulars" style="margin-top:10px">
                    <div class="particularInner">
                        <table class="table table-bordered">
                            <thead>
                                <tr style="font-weight:bold!important">
                                    <th>
                                        <b> Sr.No.</b>
                                    </th>
                                    <th>
                                        <b>HAWB</b>
                                    </th>
                                    <th width="13%">
                                        <b>Sender Name & Address</b>
                                    </th>
                                    <th>
                                        <b>Sender Country</b>
                                    </th>
                                    <th width="13%">
                                        <b>Receiver Name & Address</b>
                                        
                                    </th>
                                    <th>
                                        <b>Receiver Country</b>
                                        
                                    </th>
                                    @*<th width="8%">
                                        Destination
                                    </th>*@
                                    <!--<th width="8%">
                                    Contents
                                </th>-->
                                    <th>
                                        <b> Pcs</b>
                                    </th>
                                    <th>
                                        <b>Weight</b>
                                    </th>
                                    <th>
                                        <b>Description</b>
                                    </th>
                                    <th>
                                        <b>Value</b>
                                    </th>

                                    <th>
                                        <b>Bag No.</b>
                                    </th>
                                    <!-- <th>
                                    Charge
                                </th>
                                <th>
                                    F.Agent
                                </th>
                                <th>
                                    F.A. AWB
                                </th>
                                <th>
                                    F.A. Date
                                </th>
                                <th class="text-right">
                                    F.A.Charge
                                </th>
                                <th class="text-right">
                                    O.Charge
                                </th>
                                <th>
                                    Flight
                                </th>-->
                                </tr>
                            </thead>
                            <tbody class="input-table">
                                @foreach (var shipment in Model.ShipmentsVM)
                                {
                                    <tr>
                                        <td>@i</td>
                                        <td>@shipment.AWBNo</td>
                                        <td>
                                            @shipment.Shipper<br />
                                            @shipment.ConsignorAddress1 <br />
                                            @shipment.ConsignorAddress2 <br />
                                            @shipment.ConsignorPhone <br />
                                            @shipment.OriginCity

                                        </td>
                                        <td style="vertical-align:top">@shipment.OriginCountry</td>
                                        <td>
                                            @shipment.Receiver <br />
                                            @shipment.ConsigneeAddress1 <br />
                                            @shipment.ConsigneeAddress2 <br />
                                            @shipment.ConsigneePhone <br />
                                            @shipment.DestinationCity
                                        </td>
                                        <td>@shipment.DestinationCountry</td>
                                        <!--  <td>@shipment.Contents</td>-->
                                        <td>@shipment.PCS</td>
                                        <td>@shipment.Weight.ToString("0.000")</td>
                                        <td></td>
                                        <td></td>
                                        <td>@shipment.BagNo</td>
                                        <!--  <td>@shipment.CustomsValue.ToString("0.00") @shipment.CurrenySymbol</td>
                                    <td>@shipment.FwdAgentName</td>
                                    <td>@shipment.FwdAgentAWBNo</td>
                                    <td class="text-right">@shipment.FwdDate</td>
                                    <td class="text-right">@shipment.FwdCharge</td>
                                    <td class="text-right">@shipment.OtherCharge</td>
                                    <td>@shipment.FwdFlight</td>-->

                                    </tr>
                                    i++;
                                }
                            </tbody>
                        </table>

                    </div>
                </section>

            </div>
        </div>
    </div>
    </div>
<script>
    $(document).ready(function () {
        $("#exportshipment").addClass("active");
    });
</script>
 


@section scripts{


    <script src="~/Content/plugins/excel/jquery.table2excel.js"></script>
}