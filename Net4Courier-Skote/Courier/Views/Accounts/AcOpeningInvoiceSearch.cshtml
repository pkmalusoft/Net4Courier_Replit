@model Net4Courier.Models.OpeningInvoiceSearch

@{
    Layout = null;
    //var Customers = ViewBag.Customers as IEnumerable<LTMSV2.Models.CustomerMaster>;
    //var Suppliers = ViewBag.Suppliers as IEnumerable<LTMSV2.Models.SupplierMaster>;
    //var Agents = ViewBag.Agents as IEnumerable<LTMSV2.Models.ForwardingAgentMaster>;
}
<style>
    .pageTabs {
        padding-top: 0!important;
        padding-bottom:0!important;    
        margin:0;
    }
    .searchnav{
        margin:35px 0 20px 0!Important;
    }
    .searchnav input{
        margin:0;
        height:auto!important;
    }
    .searchnav .form-control{
        height:30px!important;
    }
    
</style>
<script type="text/javascript">
    function EnableAdd() {
        $('#btnadd').removeAttr('disabled');
        $('#btnsave').removeAttr('disabled');
    }
    function DisabledAdd() {
        $('#btnadd').attr('disabled', 'disabled');
        $('#btnsave').attr('disabled', 'disabled');
    }
    function DisplayLabel() {
        
        if ($('#Customer').prop('checked')) {
            
            $('#lblPartyName').html('Customer');
            
        }
        else if ($('#Forwarding').prop('checked')) {
            
            $('#lblPartyName').html('Forwarding Agent');
            
        }
        else if ($('#CoLoader').prop('checked')) {

            $('#lblPartyName').html('CO Loader');

        }
        else {            
            $('#lblPartyName').html('Supplier');
            
        }
    }
    $(document).ready(function () {
        var url = '/Accounts/GetSupplierName';
        
        $("#PartyName").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: url,
                    datatype: "json",
                    data: {
                        term: request.term, SupplierTypeId: $('#InvoiceType').val()
                    },
                    success: function (data) {
                        response($.map(data, function (val, item) {
                            return {
                                label: val.SupplierName,
                                value: val.SupplierName,
                                ID: val.SupplierID,
                            }
                        }))
                    }
                })
            },
            minLength: 1,
            autoFocus: false,
            focus: function (e, i) {                
                $("#PartyName").val(i.item.label);
                $('#PartyId').val(i.item.ID);
                DisabledAdd();
            },
            select: function (e, i) {
                e.preventDefault();
                $("#PartyName").val(i.item.label);
                $('#PartyId').val(i.item.ID);
                DisabledAdd();
            },
        });
        //$('input[type=radio][name=Type]').val($('#InvoiceType').val());
        $('input:radio[name=Type][value=' + $('#InvoiceType').val() + ']').prop('checked', true);
        $('input[type=radio][name=Type]').change(function () {
            if (this.value == 'C') {
                $('#PartyName').val('');
                $('#PartyId').val('0');
                $('#InvoiceType').val('C');    
                $('#lblPartyName').html('Customer');
                DisabledAdd();
            }
            else if (this.value == 'F') {
                $('#PartyName').val('');
                $('#PartyId').val('0');
                $('#InvoiceType').val('F');
                $('#lblPartyName').html('Forwarding Agent');
                DisabledAdd();
            }
            else if (this.value == 'L') {
                $('#PartyName').val('');
                $('#PartyId').val('0');
                $('#InvoiceType').val('L');
                $('#lblPartyName').html('CO Loader');
                DisabledAdd();
            }
            else if (this.value == 'S') {  
                $('#PartyName').val('');
                $('#PartyId').val('0');
                $('#InvoiceType').val('S');
                $('#lblPartyName').html('Supplier');
                DisabledAdd();
            }
           
        });
               
        setTimeout(function () {
            DisplayLabel();
        }, 100);

    
    });
   
    function setThreeNumberDecimal(obj) {
        $(obj).val(parseFloat($(obj).val()).toFixed(3));
    }
</script>

    @if (TempData["SuccessMsg"] != null)
    {
        <script type="text/javascript">
                  $(document).ready(function () {
                      $.notify("@TempData["SuccessMsg"]", "success");
                 });
        </script>
    }

    @using (Html.BeginForm("AcOpeningInvoiceSearch", "Accounts", FormMethod.Post, new { @id = "invoiceOpeningsearch" }))
    {
        @Html.ValidationSummary(true)
        <div id="validations" style="color:red;margin-left:7px;display:none">* Please fill mandatory fields</div>
        <fieldset>
            <div class="row">
                <div class="col-md-2  border-right form-group  pageTabs ">
                    <div class="field checkboxdesign verticalcheckbox">
                        <input type="radio" id="Customer" name="Type" value="C" checked="checked">
                        <label for="Customer" class="headinglabel ">Customers  </label>
                    </div>
                    <div class="field checkboxdesign verticalcheckbox">
                        <input type="radio" id="CoLoader" name="Type" value="L">
                        <label for="Supplier" class="headinglabel "> CO Loader  </label>
                    </div>
                    <div class="field checkboxdesign verticalcheckbox">
                        <input type="radio" id="Supplier" name="Type" value="S">
                        <label for="Supplier" class="headinglabel "> Suppliers  </label>
                    </div>
                    <div class="field checkboxdesign verticalcheckbox">
                        <input type="radio" id="Forwarding" name="Type" value="F">
                        <label for="Supplier" class="headinglabel "> Forwarding Agent  </label>
                    </div>
                </div>
                <div class="col-md-10" style="padding-left:30px">
                    <div class="row">
                        <div class="col-md-2 ">
                        <div class="mb-2">
                            <label class="col-form-label">Opening Date</label>
                            @Html.TextBoxFor(model => model.OpeningDate, new { @class = "form-control text-right",@readonly="readonly" })
                            @*<input type="text" class="form-control" value=@LTMSV2.Models.CommonFunctions.GetShortDateFormat(Model.OpeningDate) />*@
                        </div>
                         </div>
                        <div class="col-md-4">
                         <div class="mb-2">
                            <label class="col-form-label required" id="lblPartyName">Customer</label>
                            @Html.TextBoxFor(model => model.PartyName, new { @class = "form-control" })
                            @Html.HiddenFor(model => model.PartyId)
                            @Html.HiddenFor(model => model.InvoiceType)
                        </div>
                        </div>
                        <div class="col-md-1">
                         <div class="mb-2 mt-2">
                            <button type="submit" class="btn btn-success waves-effect waves-light filter btn_top">
                                <i class="bx bx-search mt-1" style="font-size: 21px;"></i>
                            </button>
                        </div>
                        </div>
                        <div class="col-md-5 text-md-end btn_top">
                           <div class="mb-2 mt-2">
                            <input type="button" value="Save" class="btn btn-success" data-toggle="tooltip" title="Click here" id="btnsave" />
                            @*<input type="button" value="Cancel" class="btn btn-danger btnwidth" data-toggle="tooltip" title="Click here" id="btncancel" />*@
                            @*<input type="button" value="Back" class="btn btn-danger btnwidth" data-toggle="tooltip" title="Click here" id="btnBack" />*@
                            <a href='@Url.Action("AcOpeningInvoiceIndex", "Accounts", new { type= "All" })' class="btn btn-secondary" >Cancel</a>
                        </div>
                        </div>
                     </div>
                </div>            
            </div>
        </fieldset>
    }
