@model Net4Courier.Models.QuickAWBVM
@{
     
    ViewBag.pTitle = "AirWay Bill";
    ViewBag.pageTitle = "Domestic Shipment";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var _decimal = Convert.ToInt32(@Session["Decimal"].ToString());
    var _mindate = @Net4Courier.Models.CommonFunctions.GetMinFinancialDate(); //'2020/01/01',
    var _maxdate = @Net4Courier.Models.CommonFunctions.GetMaxFinancialDate();
    int otherchargecount = 0;
    int itemcount = 0;
    var _alphanum = Session["AWBAlphaNumeric"].ToString();

}




<script type="text/javascript">
    //$(window).load(function () {
    //    alert("window load complete");

    //});

    window.onload = function () {

        if (@ViewBag.PeriodLock== true) {
            $('#btnsave').attr('disabled', 'disabled');
            Swal.fire('Data Validation','@ViewBag.PeriodLockMessage',"error");

        }
    }
    function showimportawb() {
        if ($('#HAWBNo').val() == '' || $('#HAWBNo').val()==null) {
            $.notify('Enter AWB No.!');
            return;
        }
        if ($('#ParentAWBNo').val() !='') {
            $('#txtImportAWBNo').val($('#ParentAWBNo').val());
            $('#txtImportInscanID').val($('#ParentInScanID').val());
            CheckImportAWBReference();
        }
        $('#AddImportAWBpopup').modal('show');
    }
    function SaveImportAWBReference() {
        debugger;
        $('#ParentAWBNo').val($('#txtImportAWBNo').val());
        $('#ParentInScanID').val($('#txtImportInscanID').val());
        $('#aImportAWB').html($('#ParentAWBNo').val());
        $('#aImportAWB').css('color', 'red');
        var country = $('#txtImportAWBConsigneeCountry').val();
        var city = $('#txtImportAWBConsignee').attr('City');
        var location = $('#txtImportAWBConsignee').attr('Location');
        var phone=$('#txtImportAWBConsignee').attr('Phone');
        var mobile=$('#txtImportAWBConsignee').attr('Mobile');
        var contact = $('#txtImportAWBConsignee').attr('Contact');
        var add1 = $('#txtImportAWBConsignee').attr('Address1');
        var add2 = $('#txtImportAWBConsignee').attr('Address2');
        var add3 = $('#txtImportAWBConsignee').attr('Address3');
        $('#shippername').val($('#txtImportAWBConsignee').val());
        $('#ConsignorContact').val(contact);
        $('#ConsignorLocationName').val(location);
        $('#ConsignorCityName').val(city);
        $('#ConsignorCountryName').val(country);
        $('#ConsignorPhone').val(phone);
        $('#ConsignorMobile').val(mobile);
        $('ConsignorAddress1_Building').val(add1);
        $('#ConsignorAddress2_Street').val(add2);
        $('#ConsignorAddress3_PinCode').val(add3);
        var customerid = $('#txtImportAWBConsignee').attr('CustomerID');
        var customername = $('#txtImportAWBConsignee').attr('CustomerName');
        $('#CustomerID').val(customerid);
        $('#customer').val(customername);

        var weight = $('#txtImportAWBConsignee').attr('Weight');
        var piecs = $('#txtImportAWBConsignee').attr('Piecs');
        var desc = $('#txtImportAWBConsignee').attr('CargoDescription');
        var producttypeid = $('#txtImportAWBConsignee').attr('ProductTypeID');
        var parceltyeid = $('#txtImportAWBConsignee').attr('ParcelTypeID');
        $('#Weight').val(weight);
        $('#Pieces').val(piecs);
        $('#Description').val(desc);
        $('#ProductTypeID').val(producttypeid);
        $('#ParcelTypeID').val(parceltyeid);

        $('#AddImportAWBpopup').modal('hide');
        $('#Consignee').focus();
    }
    function RemoveImportAWBReference() {
        debugger;
        $('#ParentAWBNo').val('');
        $('#ParentInScanID').val(0);
        $('#txtImportAWBNo').val('');
        $('#txtImportInscanID').val(0);
        //$('#shippername').val('');
        //$('#ConsignorContact').val('');
        //$('#ConsignorLocationName').val('');
        //$('#ConsignorCityName').val('');
        //$('#ConsignorCountryName').val('');
        //$('#ConsignorPhone').val('');
        //$('#ConsignorMobile').val('');
        //$('#customer').val('');
        //$('#Weight').val(0);
        //$('#Pieces').val(0);
        //$('#Description').val('');
        //$('#ProductTypeID').val(0);
        //$('#ParcelTypeID').val(0);

        $('#aImportAWB').css('color', '#3c8dbc');
        $('#aImportAWB').html('<i class="fa fa-bars"></i>');

        $('#AddImportAWBpopup').modal('hide');
        $('#HAWBNo').focus();
    }
    function CheckImportAWBReference() {
        //GetImportAWBRef
        $.ajax({
            type: 'GET',
            url: '@Url.Action("GetImportAWBRef", "AWB")',
            datatype: "json",
            data: { AWBNo: $('#txtImportAWBNo').val() },
            success: function (response) {
                debugger;
                console.log(response);
                var data = response.data;

                if (response.Status == 'Ok') {
                    $('#txtImportAWBConsignor').val(data.Consignor);
                    $('#txtImportInscanID').val(data.InScanID);
                    var myDate = new Date(data.AWBDate.match(/\d+/)[0] * 1);
                    var cmon = myDate.getMonth() + 1;
                    var entrydate = myDate.getDate() + "-" + cmon + "-" + myDate.getFullYear();
                    $('#txtImportAWBDate').val(entrydate);

                    $('#txtImportAWBConsignee').val(data.Consignee);
                    $('#txtImportAWBConsignee').attr('City', data.ConsigneeCity);
                    $('#txtImportAWBConsignee').attr('Location', data.ConsigneeLocation);
                    $('#txtImportAWBConsignee').attr('Phone', data.ConsigneePhone);
                    $('#txtImportAWBConsignee').attr('Mobile', data.ConsigneeMobile);
                    $('#txtImportAWBConsignee').attr('Contact', data.ConsigneeContact);
                    $('#txtImportAWBConsignee').attr('Address1', data.ConsigneeAddress1);
                    $('#txtImportAWBConsignee').attr('Address2', data.ConsigneeAddress2);
                    $('#txtImportAWBConsignee').attr('Address3', data.ConsigneeAddress3);

                    $('#txtImportAWBConsignee').attr('CustomerID', data.CustomerID);
                    $('#txtImportAWBConsignee').attr('CustomerName', data.CustomerName);
                    $('#txtImportAWBConsignee').attr('Weight', data.Weight);
                    $('#txtImportAWBConsignee').attr('Piecs', data.Piecs);
                    $('#txtImportAWBConsignee').attr('CargoDescription', data.CargoDescription);
                    $('#txtImportAWBConsignee').attr('ProductTypeID', data.ProductTypeID);
                    $('#txtImportAWBConsignee').attr('ParcelTypeID', data.ParcelTypeID);

                    $('#txtImportAWBConsignorCountry').val(data.ConsignorCountry);
                    $('#txtImportAWBConsigneeCountry').val(data.ConsigneeCountry);

                }
                else {
                    $('#txtImportAWBConsignor').val('');
                    $('#txtImportAWBConsignee').val('');
                    $('#txtImportAWBConsignorCountry').val('');
                    $('#txtImportAWBConsigneeCountry').val('');
                    $('#txtImportAWBConsignee').attr('City', '');
                    $('#txtImportAWBConsignee').attr('Location', '');
                    $('#txtImportAWBConsignee').attr('Phone', '');
                    $('#txtImportAWBConsignee').attr('Mobile', '');
                    $('#txtImportAWBConsignee').attr('Contact', '');
                    $('#txtImportAWBConsignee').attr('Address1', '');
                    $('#txtImportAWBConsignee').attr('Address2', '');
                    $('#txtImportAWBConsignee').attr('Address3', '');
                    $('#txtImportAWBConsignee').attr('CustomerID', 0);
                    $('#txtImportAWBConsignee').attr('CustomerName', '');
                    $('#txtImportAWBConsignee').attr('Weight', '');
                    $('#txtImportAWBConsignee').attr('Piecs', '');
                    $('#txtImportAWBConsignee').attr('CargoDescription', '');
                    $('#txtImportAWBConsignee').attr('ProductTypeID', '');
                    $('#txtImportAWBConsignee').attr('ParcelTypeID', '');
                }
            }
        });
    }

    function LoadCustomerDetail() {
        debugger;
        if ($('#customer').val() !='') {
            $.ajax({
                type: "POST",
                url: "/PickUpRequest/GetCustomerDataByName",
                datatype: "Json",
                data: { CustomerName: $('#customer').val() },
                success: function (data) {
                    $('#CustomerID').val(data.CustID);
                    $("#custcode").val(data.CustCode);
                    $("#Consignor").val(data.CustName);
                    $("#ConsignorContact").val(data.ContactPerson);
                    $("#ConsignorAddress1_Building").val(data.Address1);
                    $("#ConsignorAddress2_Street").val(data.Address2);
                    $("#ConsignorAddress3_PinCode").val(data.Address3);

                    $("#ConsignorPhone").val(data.Phone);
                    $("#ConsignorCountryName").val(data.CountryName);
                    $("#ConsignorCityName").val(data.CityName);
                    $("#ConsignorLocationName").val(data.LocationName);
                    $("#OfficeTimeFrom").val(data.OfficeOpenTime);
                    $("#OfficeTimeTo").val(data.OfficeCloseTime);
                    $("#hdnCustomerType").val(data.CustomerType);
                    $('#ConsignorMobile').val(data.Mobile);
                }
            });
        }
    }




    //customer and shipper autocomplete
    $(document).ready(function () {
        document.addEventListener('keydown', function (event) {
            if (event.code == 'KeyC' && (event.altKey)) {
                showcustomerentry();
            }
            if (event.code == 'KeyL' && (event.altKey)) {
                $('#lblconsignorLocation').attr('popup', 'open');
                $('#lblconsigneeLocation').attr('popup', '');
                showLocationEntry();
            }
            if (event.code == 'KeyN' && (event.altKey)) {
                $('#lblconsignorLocation').attr('popup', '');
                $('#lblconsigneeLocation').attr('popup', 'open');
                showLocationEntry();
            }
        });
        $('#lblcustomer').click(function () {
            showcustomerentry();
        })
        $('#lblconsignorLocation').click(function () {
            $('#lblconsignorLocation').attr('popup', 'open');
            $('#lblconsigneeLocation').attr('popup', '');
            showLocationEntry();
        })

        $('#lblconsigneeLocation').click(function () {
            $('#lblconsignorLocation').attr('popup', '');
            $('#lblconsigneeLocation').attr('popup', 'open');
            showLocationEntry();
        })

        $('#ProductTypeID').change(function () {
            //GetProductTypeDetail
            $.ajax({
                type: "GET",
                url: "/AWB/GetProductTypeDetail",
                datatype: "Json",
                data: { 'id': $('#ProductTypeID').val() },
                success: function (response) {
                    var _weight = response.VolumeWeight;
                    var volumebase = response.Volume;
                    $('#CBMbasedCharges').val(0);
                    $('#VolumeMetricBased').val(0);
                    if (response.CBMBased != null && response.CBMBased==true ) {
                        $('#CBMbasedCharges').val(1);
                    }

                    if (response.Length != null) {
                        $('#CBMLength').val(response.Length);
                    }

                    if (response.Width != null) {
                        $('#CBMWidth').val(response.Width);
                    }
                    if (response.Height != null) {
                        $('#CBMHeight').val(response.Height);
                    }
                    if (volumebase != null && volumebase==true) {
                        $('#VolumeMetricBased').val(1);
                        if (_weight == null) {
                            $('#lblvolumeweight').html('');
                        } else {
                            if (parseFloat(_weight) > 0)
                                $('#lblvolumeweight').html('Volume Wt.: '+_weight + ' Kg');
                            else {
                                $('#lblvolumeweight').html('');
                            }
                        }
                    }
                 

                }
            });
        })


        //setTimeout(function () {
        //    $('#PaymentModeId').trigger('change');
        //}, 500)

    });

</script>
<script type="text/javascript">
    function noaction() {
        alert("Page under development!");
    }


     function setTwoNumberDecimal(obj) {

         $(obj).val(parseFloat($(obj).val()).toFixed(@_decimal));
         CalculateTax();
    }
    function setThreeNumberDecimal(obj) {

        if ($(obj).val() == '') {
            $(obj).val(0);
        }
        else {
            $(obj).val(parseFloat($(obj).val()).toFixed(3));
        }

}
    function isNumberKey(evt)
       {
          var charCode = (evt.which) ? evt.which : evt.keyCode;
          if (charCode != 46 && charCode > 31
            && (charCode < 48 || charCode > 57))
             return false;

          return true;
    }
    function isNumberKey1(evt)
       {
        var charCode = (evt.which) ? evt.which : evt.keyCode;
          //if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
          if (charCode!=8 && charCode!=0 && (charCode < 48 || charCode > 57))
             return false;

          return true;
    }
    function AddCharge() {
        alert($('#OtherChargeID').val());
        alert($('#txtotherchargeamt_99').val());
    }
    function UpdateCharge(index) {
        alert($('#othercharges_' + index + '__OtherChargeID').val());
        alert($('#txtotherchargeamt_'+index).val());


    }

    function ShowOtherChargesModal() {
        $('#OtherChargesModal').modal('show');
    }
    function ShowStatusModal() {

          $.ajax({
            type: "POST",
            url: "/AWB/GetActiveStatus",
            datatype: "Json",
            data: { 'InScanID': $('#InScanID').val() },
            success: function (response) {
                var _detail = response.data;
                //$('#ChangeStatusTypeId').val(0).tigger('change');
                $('#ChangeStatusTypeId').val(_detail.StatusTypeID).trigger('change');
                //if (_detail.CourierStatusID != null)
                //$('#ChangeCourierStatusId').val(_detail.CourierStatusID);

                 $('#StatusModal').modal('show');

            }
        });

    }

    //not in use
     function GetConsigneeDetail() {

         $.ajax({
             type: "POST",
             url: "/PickUpRequest/GetConsigneeData",
             datatype: "Json",
             data: { consigneename: $('#Consignee').val() },
                success: function (data) {
                    if (data != null && data.CustName!=null) {
                        $("#Consignee").val(data.CustName);
                        $("#ConsigneeContact").val(data.ContactPerson);
                         $("#ConsigneeAddress1_Building").val(data.Address1);
                        $("#ConsigneeAddress2_Street").val(data.Address2);
                       $("#ConsigneeAddress3_PinCode").val(data.Address3);
                        $("#ConsigneePhone").val(data.Phone);
                        $("#ConsigneeCountryName").val(data.CountryName);
                        $("#ConsigneeCityName").val(data.CityName);
                        $("#ConsigneeLocationName").val(data.LocationName);




                    }
                    else {

                        $("#ConsigneeContact").val('');
                        $("#ConsigneeAddress1_Building").val('');
                        $("#ConsigneeAddress2_Street").val('');
                        $("#ConsigneeAddress3_PinCode").val('');
                        $("#ConsigneePhone").val('');
                        $("#ConsigneeCountryName").val('');
                        $("#ConsigneeCityName").val('');
                        $("#ConsigneeLocationName").val('');
                    }
                }
            });

    }

    function ShowNotification() {
        GetCustomerNotification();
        $('#CustomerNotifiyModal').modal('show');

    }
    function ShowStaffNotes() {
        GetStaffNotes();
        $('#StaffNotesModal').modal('show');

    }

    function savestaffnotes() {

        var obj = {
            'NotesId': $('#hdnStaffNotesId').val(),
            'InScanId': $('#InScanID').val(),
            'Notes': $('#staffnotes').val()
        }

        $.ajax({
            type: "POST",
            url: "/AWB/SaveStaffNotes",
            datatype: "Json",
            data: obj,
            success: function (response) {
                if (response.status == "ok") {
                    $.notify("Notes Updated Successfully!", "success");
                    GetStaffNotes();
                    $('#staffnotes').val('');
                }
            }
            });
    }

    function GetStaffNotes() {
        $.ajax({
            type: "Get",
            url: "/AWB/GetStaffNotes",
            datatype: "Json",
            data: { InScanId: $('#InScanID').val() },
                success: function (response) {
                    if (response.status == "ok") {
                         $("#notesdetailsbody").html('');
                        $.each(response.data, function (index, item) {

                            var myDate = new Date(item.EntryDate.match(/\d+/)[0] * 1);
                            var cmon = myDate.getMonth() + 1;
                            var entrydate = myDate.getDate() + "-" + cmon + "-" + myDate.getFullYear() + ' ' + myDate.getHours() + ':' + myDate.getMinutes();

                            // <td><a notesid="' + item.NotesId + '" href="javascript:void(0);" class="rem">Remove</a></td>
                            $("#notesdetailsbody").append('<tr notesid="' + item.NotesId + '"><td>' + (parseInt(index) + 1) + '</td><td>' + item.Notes + '</td><td>' + entrydate + '</td><td>' + item.EmployeeName + '</td></tr>');
                        });
                    }
                }
            });
    }

     function savecustomernotification() {

        var obj = {
            'NotificationId': $('#hdnNotificationId').val(),
            'InScanId': $('#InScanID').val(),
            'NotifyByEmail': $('#Email').val(),
            'NotifyBySMS': $('#Email').val(),
            'NotifyByWhatsApp': $('#WhatsApp').val(),
            'MessageText': $('#notifymessage').val(),
            'CustomerEmail': $('#txtcustomeremail').val(),
            'CustomerName': $('txtcustomername').val(),
            'AWBNo': $('#HAWBNo').val()
        }

        $.ajax({
            type: "POST",
            url: "/AWB/SaveCustomerNotification",
            datatype: "Json",
            data: obj,
            success: function (response) {
                if (response.status == "ok") {
                    $.notify("Notification Updated Successfully!", "success");
                    GetCustomerNotification();
                    $('#notifymessage').val('');
                }
            }
            });
    }
    function GetCustomerNotification() {
        $.ajax({
            type: "Get",
            url: "/AWB/GetCustomerNotification",
            datatype: "Json",
            data: { InScanId: $('#InScanID').val() },
                success: function (response) {
                    if (response.status == "ok") {
                        $('#txtcustomername').val(response.customername);
                        $('#txtcustomeremail').val(response.custemail);
                         $("#notificationdetailsbody").html('');
                        $.each(response.data, function (index, item) {

                            var myDate = new Date(item.EntryDate.match(/\d+/)[0] * 1);
                            var cmon = myDate.getMonth() + 1;
                            var entrydate = myDate.getDate() + "-" + cmon + "-" + myDate.getFullYear() + ' ' + myDate.getHours() + ':' + myDate.getMinutes();

                            // $('#details tr').length - 1;
                            //<td><a notesid="' + item.NotificationId + '" href="javascript:void(0);" class="rem">Remove</a></td>
                            $("#notificationdetailsbody").append('<tr notificationid="' + item.NotificationId + '"><td>' + (parseInt(index) + 1) + '</td><td>' + item.MessageText + '</td><td>' + entrydate + '</td><td>' + item.EmployeeName + '</td></tr>');
                        });
                    }
                }
            });
    }
    function calvolumeweight() {

        debugger;
        var l = parseFloat($("#CBMLength").val());
        var w = parseFloat($("#CBMWidth").val());
        var h = parseFloat($("#CBMHeight").val());

        if ($('#CBMbasedCharges').val() == '1') {
            var CBM = l * w * h;
            CBM = parseFloat(CBM) / 1000000;
            //$("#CBM").val(parseFloat(CBM).toFixed(3));
            $("#lblvolumeweight").html('CBM :' + parseFloat(CBM).toFixed(3) + 'Kg');
        } else if ($('#VolumeMetricBased').val() == '1') {
            var CBM = l * w * h;
            CBM = parseFloat(CBM) / 5000;
            $("#lblvolumeweight").html('Vol. Wt :' + parseFloat(CBM).toFixed(0) + 'Kg');
        } else {
            var CBM = l * w * h;
            CBM = parseFloat(CBM) / 5000;
            $("#lblvolumeweight").html('Vol. Wt :' + parseFloat(CBM).toFixed(0) + 'Kg');
        }


    }
    $(document).ready(function () {
        $(":text").css({ "border-radius": "5px" });
        $("select").css({ "border-radius": "5px" });

        $("#HAWBNo").focus();

       
        $("#OtherChargeName").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '/AWB/GetOtherChargeAll',
                    datatype: "json",
                    data: {
                        term: request.term
                    },
                    success: function (data) {
                        response($.map(data, function (val, item) {
                            return {
                                label: val.OtherCharge1,
                                value: val.OtherCharge1,
                                OtherChargeID: val.OtherChargeID,
                                AcHeadID: val.AcHeadID
                            }
                        }))
                    }
                })
            }, minLength: 1,
            autoFocus: true,
            select: function (e, i) {
                e.preventDefault();
                $("#OtherChargeName").val(i.item.label);
                $('#OtherChargeID').val(i.item.OtherChargeID);
                $('#OtherChargeAcHeadID').val(i.item.AcHeadID);
            }
        });
        $(".Allocate").on("click", function () {

            $('#popup').modal('show');
            //$('#popupbackground').show();
        });

        $(".ItemShipment").on("click", function () {

            $('#itempopup').modal('show');
            //$('#popupbackground').show();
        });


        $("#AllocationClose").on("click", function () {
            $('#popup').modal('hide');
            //$('#popupbackground').hide();
        });


        function CalcTotal() {
            var x = $("#CourierCharge").val();
            //var y = $("#PackingCharge").val();
            var z = $("#OtherCharge").val();
            //var a = $("#CustomCharge").val();
            var tot = parseFloat(x) + parseFloat(z); // + parseFloat(a); parseFloat(y)

            $("#totalCharge").val(tot.toFixed(2));
        }

        $("#CourierCharge").change(function () {
            if ($(this).val() == null) {
                $(this).val('0.00');
            }
            CalculateTax();
        });
        //$("#PackingCharge").blur(function () {
        //    if ($(this).val() == null) {
        //        $(this).val('0.00');
        //    }
        //    CalcTotal();
        //});
        $("#OtherCharge").blur(function () {
            if ($(this).val() == null) {
                $(this).val('0.00');
            }
            CalculateTax();
        });
        //$("#CustomCharge").blur(function () {
        //    if ($(this).val() == null) {
        //        $(this).val('0.00');
        //    }
        //    CalcTotal();
        //});

        $('#MovementTypeID').change(function () {
            var materialcost = 0;

            if (@ViewBag.EditMode== true) {
                materialcost = $('#materialcost').val();
                if (materialcost == '')
                    materialcost = 0;
                if (parseFloat(materialcost) > 0) {
                    $('#materialcost').removeAttr('Disabled');
                }
                return;
            }
            else {
                var movetype = $('#MovementTypeID option:selected').text();

                if (movetype == 'Domestic' || movetype == 'Export') {
                    $('#materialcost').removeAttr('Disabled');
                }
                else {
                    $('#materialcost').val(0);
                    $('#materialcost').attr('Disabled', 'disabled');
                }
            }

        });

        $('#Weight').change(function () {

            var weightval = parseFloat($('#Weight').val());
            if (weightval > 30 && $('#ParcelTypeID').val() != 4) {
                if ($('#ParcelTypeID').val() == 0) {
                    $('#ParcelTypeID').val(4);
                }
                else {
                    $('#ParcelTypeID').val(4);
                    //alert('Weight is only less than 30kg to this parcel type!');
                }
            }
            else if (weightval <= 30 && $('#ParcelTypeID').val() !=3) {
                $('#ParcelTypeID').val(3);
                //alert('Weight should be above than 30kg to this selcted parceltype!');
            }

        });

        //$('#ConsigneeCityName').change(function () {
        //    if ($('#ConsigneeCityName').val() == $('#ConsignorCityName').val() || ($('#ConsigneeCountryName').val() == $('#ConsignorCountryName').val()))
        //         {
        //        $('#MovementTypeID').val(1);
        //        $('#materialcost').removeAttr('Disabled');
        //        }
        //        else if ($('#ConsigneeCountryName').val() != $('#ConsignorCountryName').val()) {
        //        $('#MovementTypeID').val(2);
        //        $('#materialcost').val(0);
        //        $('#materialcost').attr('Disabled', 'disabled');
        //    }

        //});

        // $('#ConsigneeCountryName').change(function () {
        //    if ($('#ConsigneeCityName').val() == $('#ConsignorCityName').val() || ($('#ConsigneeCountryName').val() == $('#ConsignorCountryName').val()))
        //         {
        //        $('#MovementTypeID').val(1);
        //        $('#materialcost').removeAttr('Disabled');
        //        }
        //        else if ($('#ConsigneeCountryName').val() != $('#ConsignorCountryName').val()) {
        //        $('#MovementTypeID').val(2);
        //        $('#materialcost').val(0);
        //        $('#materialcost').attr('Disabled', 'disabled');
        //     }

        // });

        $('#ChangeStatusTypeId').change(function () {

            var pcourierstatusid = $('#CourierStatusId').val();
            if (pcourierstatusid == null)
                pcourierstatusid = 0;

            $.ajax({
                type: "POST",
                url: "/AWB/GetStatus",
                datatype: "Json",
                data: { 'StatusTypeId' : $('#ChangeStatusTypeId').val() },
                success: function (response) {

                    //$('#CourierStatusId').select2("destroy");
                     //$("#ChangeCourierStatusId").select2('destroy');
                     $('#ChangeCourierStatusId').html('');
                    var opthtml = '<option value="0">Select</option>';
                    $(response.data).each(function (index, item) {
                        if (item.id == pcourierstatusid && pcourierstatusid!=0) {
                               opthtml += '<option  value="' + item.id + '">' + item.text + '</option>';
                        }
                        else {
                            opthtml += '<option value="' + item.id + '">' + item.text + '</option>';
                        }
                    });
                    $('#ChangeCourierStatusId').html(opthtml);
                    $('#ChangeCourierStatusId').val($('#CourierStatusId').val()).trigger('change');

                    //$('#CourierStatusId').val(response.data[2].id);
                  //  $('#ChangeCourierStatusId').select2();
                    //$('#CourierStatusId').val("2").trigger('change');
                    //$('#CourierStatusId').select2('data', response.data[2]);
                    //$('#CourierStatusId').val('2').text(response.data[2].text);


                    // $('#ChangeCourierStatusId').select2({
                    //        width: '100%',
                    //        allowClear: true,
                    //        multiple: false,
                    //        placeholder: "Select Status"
                    //        });

                    }
               });
           });
        $('#btnsavestatus').click(function () {

             var statusobj = {
                InScanID: $('#InScanID').val(),
                StatusTypeID: $('#ChangeStatusTypeId').val(),
                CourierStatusID: $('#ChangeCourierStatusId').val(),
                CourierStatusText: '' //$("#ChangeCourierStatusId option:selected").text()
            };

             $.ajax({
                type: "POST",
                url: "/AWB/SaveStatus",
                datatype: "Json",
                data: statusobj,
                success: function (response) {

                    if (response.status == "ok")
                    {
                        var statustype = $("#ChangeStatusTypeId option:selected").text();
                        var statustext = $("#ChangeCourierStatusId option:selected").text();
                        $('#StatusTypeId').val($('#ChangeStatusTypeId').val());
                        $('#CourierStatusId').val($('#ChangeCourierStatusId').val());
                        $('#h4statustype').html(statustype);
                        $('#h4courierstatus').html(response.statustext);
                        $.notify("Status Updated Successfully!", "success");
                    }
                    else
                    {
                       $.notify("Save Failed :" + data, "warning");
                    }

                    $('#StatusModal').modal('hide');

                }
            });


        });

        $("#HAWBNo").keyup(function () {
            $('#h2awb').html('<strong>' + $('#HAWBNo').val() + '</strong>');
        });
        document.addEventListener('keydown', function (event) {
            if (event.code == 'KeyA' && (event.altKey)) { //ADD AWB
                 $("#btnsave").trigger('click');
            }
        });
        $('#HAWBNo').change(function () {
             if ('@_alphanum' == 'True') {
                 var txt = $('#HAWBNo').val().trim();
                 $('#HAWBNo').val(txt.replace(/[^\d,]/g, ''));
                }
            $.ajax({
                type: "POST",
                url: "/AWB/GetAWB",
                datatype: "Json",
                data: { id: $("#HAWBNo").val() },
                success: function (data) {
                    debugger;
                    if (data.Exist == 0) {
                        $("#IsAvailable").val(0);
                        var AWBInfo = data.AWBInfo;
                        var status = AWBInfo.Status;
                        var mode = AWBInfo.Mode;
                        if (status == 'Available' && mode == 'Prepaid') {
                            var charge = response.CourierCharge;
                            $('#CourierCharge').val(parseFloat(charge).toFixed(2));
                            $('#CourierCharge').attr('readonly', 'readonly');
                            $('#PaymentModeId').val(0).trigger('change');
                            $('#PaymentModeId').val(5).trigger('change');
                            $('#PaymentModeId').attr('readonly', 'readonly');
                            $('#PaymentModeId').attr('disabled', 'disabled');
                        }
                        else if (status == 'Available' && mode == 'NotPrepaid') {
                            $('#PaymentModeId').val(0).trigger('change');
                            $('#PaymentModeId').val(3).trigger('change');
                            $('#PaymentModeId').removeAttr('readonly');
                            $('#PaymentModeId').removeAttr('disabled');
                        }
                        else {
                            //$('#PaymentModeId').val(0).trigger('change');
                            if ($('#UserType').val() == 'Employee') {
                                $('#PaymentModeId').val(3).trigger('change');
                                $('#customer').val('');
                                $('#customer').attr('AWBCustomerId', 0);
                                $('#customer').attr('AWBCustomer', '');
                                $('#shippername').val('');
                                $('#shippername').removeAttr('readonly');//, 'readonly');
                                $('#CustomerID').val(0);
                                $("#ConsignorContact").val(ContactPerson);
                                $("#ConsignorAddress1_Building").val('');
                                $("#ConsignorAddress2_Street").val('');

                                $("#ConsignorAddress3_PinCode").val('');

                                $("#ConsignorPhone").val('');
                                $("#ConsignorCountryName").val('');
                                $("#ConsignorCityName").val('');
                                $("#ConsignorLocationName").val('');
                                $("#PickupLocation").val('');
                                $("#DeliveryLocation").val('');
                                $('#PickupSubLocality').val('');
                                $('#DeliverySubLocality').val('');
                                $('#OriginPlaceID').val('');
                                $('#DestinationPlaceID').val('');
                                $("#PickupLocation").removeAttr('readonly');
                                $("#ConsignorMobileNo").val('');
                                $('#PaymentModeId').focus();
                            }
                            else {
                                Swal.fire('Data Validation', 'AWB  Not in the Issue List!', 'error');
                                $('#HAWBNo').focus();
                            }
                        }

                        if (status == 'Available') {
                            var CustomerName = AWBInfo.CustomerName;
                            var CustomerId = AWBInfo.CustomerID;
                            var LocationName = AWBInfo.LocationName;
                            var CityName = AWBInfo.CityName;
                            var CountryName = AWBInfo.CountryName;
                            var Address1 = AWBInfo.Address1;
                            var Address2 = AWBInfo.Address2;
                            var Address3 = AWBInfo.Address3;
                            var PhoneNo = AWBInfo.Phone;
                            var Mobile = AWBInfo.Mobile;
                            var OriginLocation = AWBInfo.OriginLocation;
                            var DestinationLocation = AWBInfo.DestinationLocation;
                            var ContactPerson = '';
                            var PickupSubLocality = AWBInfo.PickupSubLocality;
                            var DeliverySubLocality = AWBInfo.DeliverySubLocality;
                            var OriginPlaceID = AWBInfo.OriginPlaceID;
                            var DestinationPlaceID = AWBInfo.DestinationPlaceID;
                            //$('#InScanID').val(InScanID);
                            //$('#QuickInScanID').val(QuickInScanId);
                            $('#customer').val(CustomerName);
                            $('#customer').attr('AWBCustomerId', CustomerId);
                            $('#customer').attr('AWBCustomer', CustomerName);
                            $('#shippername').val(CustomerName);
                            $('#shippername').attr('readonly', 'readonly');
                            $('#CustomerID').val(CustomerId);
                            $("#ConsignorContact").val(ContactPerson);
                            $("#ConsignorAddress1_Building").val(Address1);
                            $("#ConsignorAddress2_Street").val(Address2);

                            $("#ConsignorAddress3_PinCode").val(Address3);

                            $("#ConsignorPhone").val(PhoneNo);
                            $("#ConsignorCountryName").val(CountryName);
                            $("#ConsignorCityName").val(CityName);
                            $("#ConsignorLocationName").val(LocationName);
                            $("#PickupLocation").val(OriginLocation);
                            $("#DeliveryLocation").val(DestinationLocation);
                            $('#PickupSubLocality').val(PickupSubLocality);
                            $('#DeliverySubLocality').val(DeliverySubLocality);
                            $('#OriginPlaceID').val(OriginPlaceID);
                            $('#DestinationPlaceID').val(DestinationPlaceID);
                            $("#PickUpLocation").attr('readonly', 'readonly');
                            $("#ConsignorMobileNo").val(Mobile);
                        }
                        else {


                        }
                    }
                    else {
                        $("#IsAvailable").val(1);
                        alert("AWB Already Exist..!");
                        $('#HAWBNo').val('');
                        $('#HAWBNo').focus();
                    }

                }
            });
        });
        $("#btnsave").click(function () {

            CalculateTax();

            //var fullform = $('#quickAWB').valid();
            //if ($("#HAWBNo1").val() != "") {
            //    $.ajax({
            //        type: "POST",
            //        url: "/AWB/GetAWB",
            //        datatype: "Json",
            //        data: { id: $("#HAWBNo").val() },
            //        success: function (data) {
            //            if (data.Exist == 0) {
            //                $("#IsAvailable").val(0);
            //            }
            //            else {
            //                $("#IsAvailable").val(1);
            //            }

            //        }
            //    });
            //}
            //if ($("#IsAvailable").val() == 1) {
            //    alert("AWB Already Exist..!");
            //    $('#HAWBNo').focus();
            //    return false;
            //}
            //else {

                var Weight = $("#Weight").val();
            var CourierCharge = $("#CourierCharge").val();
            //if (CourierCharge == "" || CourierCharge == "0" || CourierCharge == "0.00") {
            //    alert('Enter Courier Charge!');
            //    $("#CourierCharge").focus();
            //    return false;
            //}
                if (Weight != "") {
                    var weightval = parseFloat($('#Weight').val());
                    if (weightval == 0) {
                        $("#validations").show();
                        return false;
                    }
                    else if (weightval > 30 && $('#ParcelTypeID').val() != 4) {
                        alert('Invalid Parcel Type,Weight is only less than 30kg!');
                        return false;
                    }
                    else if (weightval <= 30 && $('#ParcelTypeID').val() == 4) {
                        alert('Weight should be above than 30kg to this selcted parceltype!');
                        return false;
                    }
                    else {

                        //if ($('#txtAWBProcessed').val() == '') {
                        //    alert($('#AWBProcessed').val());
                        //    if (confirm("Please click Yes to confirm about AWBProcessed?") == true) {
                        //        $('#AWBProcessed').val(true);
                        //    }
                        //}
                        $("#validations").hide();
                        return true;
                    }
                }

                //else {
                //    $("#validations").hide();
                //    return true;
                //}

        });
        $('#TransactionDate').keydown(function (e) {

            @*if (e.keyCode == 13 || e.keyCode == 9) {
                if ($("#TransactionDate").val() != "") {
                    $.ajax({
                        url: "@Url.Action("CheckDateValidate", "Accounts")",
                        data: { entrydate: $("#TransactionDate").val() },
                        type: "GET",
                        dataType: "json",
                        success: function (response) {

                            if (response.Status == "OK") {
                                datevalid = true;
                                dateerror = response.Message;
                            }
                            else {
                                datevalid = false;
                                dateerror = response.Message;

                                $('#TransactionDate').val(response.ValidDate);
                            }

                        },
                        error: function () {
                           console.log("Date Validation Failed! Please try again.");
                        }
                    });
                }*@
            //}
        });
        

        
        $("#EnquiryNo").change(function () {
            //$("#origincity").empty();
            //$('#origincity').append('<option value="0">Select</option>');

            //$("#originlocation").empty();
            //$('#originlocation').append('<option value="0">Select</option>');

            if ($('#EnquiryNo').val() == 0)
                $('#InScanID').val(0);

            $.ajax({
                type: "POST",
                url: "/AWB/GetCustomerDataByNO",
                datatype: "Json",
                data: { id: $('#EnquiryNo').val() },
                success: function (data) {
                    if (data.Exist == 1) {

                        $('#HAWBNo').val(data.AWBNo);
                         $('#h2awb').html('<strong>' + $('#HAWBNo').val() + '</strong>');
                        $("#InScanID").val(data.InScanID);
                        $("#CustomerID").val(data.CustomerID);
                        $("#Weight").val(data.Weight);
                        $("#ConsigneeCountryName").val(data.ConsigneeCountryName);
                        $("#ConsigneeCityName").val(data.ConsigneeCityName);

                        $("#ConsignorCountryName").val(data.ConsignorCountryName);
                        $("#ConsignorCityName").val(data.ConsignorCityName);

                        $("#CourierType").val(data.DescriptionID);
                        $("#ConsignorContact").val(data.ConsignorContact);
                        $("#ConsigneeContact").val(data.ConsigneeContact);
                        $("#Consignor").val(data.Consignor);
                        $("#Consignee").val(data.Consignee);
                        $("#ConsignorAddress1_Building").val(data.ConsignorAddress1_Building);
                        $("#ConsignorAddress2_Street").val(data.ConsignorAddress2_Street);
                        $("#ConsignorAddress3_PinCode").val(data.ConsignorAddress3_PinCode);

                        $("#ConsigneeAddress1_Building").val(data.ConsigneeAddress1_Building);
                        $("#ConsigneeAddress2_Street").val(data.ConsigneeAddress2_Street);
                        $("#ConsigneeAddress3_PinCode").val(data.ConsigneeAddress3_PinCode);

                        $("#ConsigneePhone").val(data.ConsigneePhone);
                        $("#ConsignorPhone").val(data.ConsignorPhone);

                        $("#ConsignorLocationName").val(data.ConsignorLocationName);
                        $("#autocomplete").val(data.ConsigneeLocationName);
                        $('#PickedBy').val(obj.CollectedEmpID);
                        //$("#ConsigneeCountryName").val(data.ConsigneeCountryName);
                        //$("#ConsigneeCityName").val(data.ConsigneeCityName);




                        //BindCity(data.CityID);




                    }
                    else {
                        alert("Data Not Found");
                    }
                }

            });
        });

        $('#materialcost').blur(function () {
            $('#btnsave').focus();
        });

        @*var startdate = '@Session["FyearFrom"].ToString()';
        var enddate = '@Session["FyearTo"].ToString()';
        var sd = new Date(startdate.split('-')[1] + '-' + startdate.split('-')[0] + '-' + startdate.split('-')[2]);
        var ed = new Date(enddate.split('-')[1] + '-' + enddate.split('-')[0] + '-' + enddate.split('-')[2]);
       
            $('#TransactionDate').datepicker({
                maxDate:ed,
                minDate: sd,
                dateFormat: 'dd-mm-yy',
            });*@
    
        var d = new Date();
        var curr_date = d.getDate();
        var curr_month = d.getMonth()+1;
        var curr_year = d.getFullYear();

        var reqdate = curr_date + "-" + curr_month + "-" + curr_year + ' ' + d.getHours() + ':' + d.getMinutes();


        var divitems = $('#divcustomer1').find('.form-control');
       
        if (@ViewBag.AutoGenerate== true) {
            $('#HAWBNo').attr('readonly', 'readonly');
        }

        if (@ViewBag.EditMode== true) {

            $('#ShipmentModeID').attr('disabled', 'disabled');
            $("#AWBAutoGenerated").attr('disabled', 'disabled');
            //if ($('#AWBProcessed').val() == True) {
            //    $('#txtAWBProcessed').val(1);
            //}
             //$('#divcustomer1').find('.form-control').each(function(index,item) {
             //   console.log(item);
             //    $(item).attr('disabled', 'disabled');
             //});

            //$('#divcustomer2').find('.form-control').each(function(index,item) {
            //    console.log(item);
            //     $(item).attr('disabled', 'disabled');
            //});

            //$('#divcustomer3').find('.form-control').each(function(index,item) {
            //    console.log(item);
            //     $(item).attr('disabled', 'disabled');
            //});
            var materialcost = $('#MaterialCost').val();
            if (materialcost == '')
                materialcost = 0;
             var movetype = $('#MovementTypeID option:selected').text();
            if (movetype == 'Domestic') {
                $('#materialcost').removeAttr('Disabled');
            }
            else if (parseFloat(materialcost) > 0)
            {
                $('#materialcost').removeAttr('Disabled');
            }
            else {
                //$('#materialcost').val(0);
                $('#materialcost').attr('Disabled', 'disabled');
            }


            if ($('#InvoiceId').val() != '' && $('#InvoiceId').val() != '0') {
                $("#CourierCharge").attr('readonly', 'readonly');
                $("#OtherCharge").attr('readonly', 'readonly');
                $("#NetTotal").attr('readonly', 'readonly');
                $('#customer').attr('disabled', 'disabled');
                $('#PaymentModeId').attr('disabled', 'disabled');
            }
            if ($('#DRRID').val() != '' && $('#DRRID').val() != '0') {
                $("#CourierCharge").attr('readonly', 'readonly');
                $("#OtherCharge").attr('readonly', 'readonly');
                $("#NetTotal").attr('readonly', 'readonly');

                $('#AcHeadName').removeAttr('required');
                $('#AcHeadName').attr('readonly', 'readonly');
                $('#PaymentModeId').attr('readonly', 'readonly');
                if ($('#PaymentModeId').val() == 3 && ($('#InvoiceId').val() == '' || $('#InvoiceId').val() == '0')) {
                    $('#customer').removeAttr('disabled');
                }
                else {
                    $('#customer').attr('disabled', 'disabled');
                }
                //$('#materialcost').attr('readonly', 'readonly');
                $('#TransactionDate').attr('readonly', 'readonly');

                    $('#AcheadID').val(0);

            }

            if ( parseFloat($('#TaxAmount').val()) != 0) {
                $('#ChkTaxPercent').prop('checked', true);
            }
            else {
                $('#ChkTaxPercent').prop('checked', false);
            }
            if (parseFloat($('#SurchargeAmount').val()) !=0) {
                $('#ChkSurcharge').prop('checked', true);
            }
            else {
                $('#ChkSurcharge').prop('checked', false);
            }


            var modeid = $('#PaymentModeId').val();
            if (modeid == 1 && $('#DRRProcess').val() == 'True') { //  $('#DRRID').val()==0) { //PKP
                $('#divcustomer').removeClass('hide');
                $('#divcash').addClass('hide');
                $('#customer').attr('readonly', 'readonly');
                $('#AcHeadName').removeAttr('required');
                $('#AcHeadName').attr('disabled', 'disabled'); //removeAttr('required');
                //$('#AcHeadName').attr('required', 'required');
            }
            else if (modeid == 1 && $('#DRRProcess').val() == 'False') { //  $('#DRRID').val()==0) { //PKP
                $('#divcustomer').addClass('hide');
                $('#divcash').removeClass('hide');
                $('#AcHeadName').removeAttr('readonly');
                $('#AcHeadName').attr('required', 'required');
            }
            else {
                if (modeid == 3) {
                    $('#customer').removeAttr('readonly');
                }
                else {
                    $('#customer').attr('readonly','readonly');
                }
                $('#divcustomer').removeClass('hide');
                $('#divcustomer').removeClass('hide');
                $('#divcash').addClass('hide');
                $('#AcHeadName').removeAttr('required');
            }
            setTwoNumberDecimal($("#CourierCharge")); //.val('0.00');
            setTwoNumberDecimal($("#PackingCharge")); //.val('0.00');
            setTwoNumberDecimal($("#OtherCharge")); //.val('0.00');
            setTwoNumberDecimal($("#CustomsValue")); //.val('0.00');
            setTwoNumberDecimal($("#totalCharge")); //.val('0.00');
            setTwoNumberDecimal($("#materialcost")); //.val('0.00');
            setTwoNumberDecimal($("#SpotRate")); //.val('0.00');
            setTwoNumberDecimal($("#MarginPercent")); //.val('0.00');
            setTwoNumberDecimal($("#ForwardingCharge")); //.val('0.00');
            setTwoNumberDecimal($("#CustomsValue")); //.val('0.00');
            if ($('#UserType').val() == 'Customer') {
                $('#customer').attr('disabled', 'disabled');
                $('#PaymentModeId').attr('disabled', 'disabled');
                $('#shippername').attr('disabled', 'disabled');
                $('#shippername').attr('disabled', 'disabled');
                $('#ConsignorContact').attr('disabled', 'disabled');
                $('#ConsignorPhone').attr('disabled', 'disabled');
                $('#ConsignorMobile').attr('disabled', 'disabled');
                $('#ConsignorAddress1_Building').attr('disabled', 'disabled');
                $('#ConsignorAddress2_Street').attr('disabled', 'disabled');
                $('#ConsignorAddress3_PinCode').attr('disabled', 'disabled');
                $('#ConsignorLocationName').attr('disabled', 'disabled');
                $('#ConsignorCityName').attr('disabled', 'disabled');
                $('#ConsignorCountryName').attr('disabled', 'disabled');
                $('#CourierCharge').attr('disabled', 'disabled');
                $('#divothercharge').addClass('hide');
            }

            $('#PaymentModeId').focus();
        }
        else {
            $('#CustomerandShipperSame').prop('checked', 'checked');
            //$('#ChkTaxPercent').prop('checked', 'checked');
              //$('#TransactionDate').val(reqdate);
            $("#CourierCharge").val('0.00');
            $("#PackingCharge").val('0.00');
            $("#OtherCharge").val('0.00');
            $("#CustomCharge").val('0.00');
            $("#totalCharge").val('0.00');
            $("#PaymentModeId").trigger('change');

        if ( $('#InScanID').val() == "0" || $('#InScanID').val() == 0 || $('#InScanID').val() == null) {
            $('#divsetting').addClass('hide');
            $('#HAWBNo').focus();
            }

            if ($('#UserType').val() == 'Customer') {
                $('#customer').attr('disabled', 'disabled');
                $('#PaymentModeId').attr('disabled', 'disabled');
                $('#shippername').attr('disabled', 'disabled');
                $('#shippername').attr('disabled', 'disabled');
                $('#ConsignorContact').attr('disabled', 'disabled');
                $('#ConsignorPhone').attr('disabled', 'disabled');
                $('#ConsignorMobile').attr('disabled', 'disabled');
                $('#ConsignorAddress1_Building').attr('disabled', 'disabled');
                $('#ConsignorAddress2_Street').attr('disabled', 'disabled');
                $('#ConsignorAddress3_PinCode').attr('disabled', 'disabled');
                $('#ConsignorLocationName').attr('disabled', 'disabled');
                $('#ConsignorCityName').attr('disabled', 'disabled');
                $('#ConsignorCountryName').attr('disabled', 'disabled');
                $('#CourierCharge').attr('disabled', 'disabled');
                $('#divothercharge').addClass('hide');
            }

    }


    });
</script>
<script>
    //get courier charge
    function getCourierCharge() {

        if ($('#CourierCharge').prop('readonly') == true) { return false; }

        if ($('#SpotRate').val() != '') {
            if (parseFloat($('#SpotRate').val()) > 0) {
                calculationspotrate();
                return false;
            }
        }        
        var CustomerRateTypeID = $('#CustomerRateTypeID').val();
        var CustomerId = $('#CustomerID').val();
        var MovementId = $('#MovementTypeID').val();
        var ProductTypeID = $('#ProductTypeID').val();
        var PaymentModeId = $('#PaymentModeId').val();
        var Weight = $('#VerifiedWeight').val();
        var CountryName = $('#ConsigneeCountryName').val();//  $('#DeliveryCountry').val(); //Delhi, India $("#ConsigneeCountryName").val();
        var CityName = $('#ConsigneeCityName').val(); // $('#DeliveryCity').val(); //$("#ConsigneeCityName").val();
        var OriginCountry = $('#ConsignorCountryName').val();// $('#OriginCountry').val(); //Delhi, India $("#ConsigneeCountryName").val();
        var OriginCity = $('#ConsignorCityName').val();// $('#OriginCity').val(); //$("#ConsigneeCityName").val();
        var checkstatus = true;
        if (PaymentModeId == 4 || PaymentModeId == '4') {
            if ($('#AWBFOCZero').val() == true || $('#AWBFOCZero').val() == 'True') {
                $('#CourierCharge').attr('min', 0);
            }
            else {
                $('#CourierCharge').attr('min', 1);
            }
        } else {
            $('#CourierCharge').attr('min', 1);
        }
        if (PaymentModeId == 5 || PaymentModeId == '5' && PaymentModeId == null) {
            checkstatus = false;
            $('#CustomerRateTypeID').val(0);
            $('#CustomerRateType').val("Manual Rate");
            $('#h2ratetype').html('Manual Rate');
           
            return false;
        }
        if (PaymentModeId == 5 || PaymentModeId == '5' && PaymentModeId == null) {
            $('#CustomerRateTypeID').val(0);
            $('#CustomerRateType').val("Manual Rate");
            $('#h2ratetype').html('Manual Rate');
            checkstatus = false;
            return false;
        }
        //if (PaymentModeId == 1 || PaymentModeId == '1' && PaymentModeId == null) {
        //    $('#CustomerRateTypeID').val(0);
        //    $('#CustomerRateType').val("Manual Rate");
        //    checkstatus = false;
        //    return false;
        //}
        if (PaymentModeId == 2 || PaymentModeId == '2' && PaymentModeId == null) {
            $('#CustomerRateTypeID').val(0);
            $('#CustomerRateType').val("Manual Rate");
            $('#h2ratetype').html('Manual Rate');
            checkstatus = false;
            return false;
        }
        else if (CustomerId == null || CustomerId == '' || CustomerId == null) {
            $('#CustomerRateTypeID').val(0);
            $('#CustomerRateType').val("Manual Rate");
            $('#h2ratetype').html('Manual Rate');
            checkstatus = false;
            return false;
        }
        else if (MovementId == null || MovementId == '') {
            $('#CustomerRateTypeID').val(0);
            $('#CustomerRateType').val("Manual Rate");
            $('#h2ratetype').html('Manual Rate');
            checkstatus = false;
            return false;
        }
        else if (ProductTypeID == null || ProductTypeID == '' || ProductTypeID == 0) {
            $('#CustomerRateTypeID').val(0);
            $('#CustomerRateType').val("Manual Rate");
            $('#h2ratetype').html('Manual Rate');
            checkstatus = false;
            return false;
        }
        else if (MovementId != 3 && (CountryName == null || CountryName == '')) { // CityName == '' || CityName == null)) {
            $('#CustomerRateTypeID').val(0);
            $('#CustomerRateType').val("Manual Rate");
            $('#h2ratetype').html('Manual Rate');
            checkstatus = false;
            return false;
        }
        else if (MovementId == 3 && (OriginCountry == null || OriginCountry == '')) { // || OriginCity == '' || OriginCity == null)) {
            $('#CustomerRateTypeID').val(0);
            $('#CustomerRateType').val("Manual Rate");
            $('#h2ratetype').html('Manual Rate');
            checkstatus = false;
            return false;
        }

        if (checkstatus) {
            $.ajax({
                url: '/AWBBatch/GetCustomerRateType',
                datatype: "json",
                data: {
                    term: '', CustomerId: $('#CustomerID').val(), MovementId: $('#MovementTypeID').val(), ProductTypeID: $('#ProductTypeID').val(), PaymentModeId: $('#PaymentModeId').val(), FAgentID: $('#FagentID').val(), CityName: $('#ConsigneeCityName').val(), CountryName: $('#ConsigneeCountryName').val(), OriginCountry: OriginCountry, OriginCity: OriginCity, Weight: Weight
                },
                success: function (response) {
                    debugger;
                    var data = response.Customerdata;
                    var FAgentRate = response.FRate;
                    //console.log(data);
                    //console.log(FAgentRate);
                    $('#ForwardingCharge').val(FAgentRate.Rate);
                    var status = '';
                    if (data.length > 0) {
                        for (var i = 0; i < data.length; i++) {

                            if ($('#CustomerRateTypeID').val() == 0) {
                                $('#CustomerRateType').val(data[i].CustomerRateType1);
                                $('#CustomerRateTypeID').val(data[i].CustomerRateTypeID);
                                $('#h2ratetype').html(data[i].CustomerRateType1);
                                GetcourierChargenew();
                                status = "ok";
                            }
                            else if (data[i].CustomerRateTypeID == $('#CustomerRateTypeID').val()) {
                                GetcourierChargenew();
                                status = "ok";
                            }

                            if ((i + 1) == data.length) {
                                if (status == '') {
                                    $('#CustomerRateType').val(data[0].CustomerRateType1);
                                    $('#h2ratetype').html(data[0].CustomerRateType1);
                                    $('#CustomerRateTypeID').val(data[0].CustomerRateTypeID);
                                    GetcourierChargenew();
                                    status = "ok";
                                }
                            }
                        }
                    }
                    else {
                        $('#CustomerRateTypeID').val(0);
                        $('#CustomerRateType').val("Manual Rate");
                        $('#CourierCharge').val(0);
                        CalculateTax();
                    }
                }
            })
        }
    }
    function GetcourierChargenew() {
        var CustomerRateTypeID = $('#CustomerRateTypeID').val();
        var CustomerId = $('#CustomerID').val();
        var MovementId = $('#MovementTypeID').val();
        var ProductTypeID = $('#ProductTypeID').val();
        var PaymentModeId = $('#PaymentModeId').val();
        var Weight = $('#VerifiedWeight').val();
        var CountryName = $('#ConsigneeCountryName').val(); //Delhi, India $("#ConsigneeCountryName").val();
        var CityName = $('#ConsigneeCountryName').val(); //$("#ConsigneeCityName").val();
        var CountryName1 = $('#ConsignorCountryName').val(); //Delhi, India $("#ConsigneeCountryName").val();
        var CityName1 = $('#ConsignorCityName').val(); //$("#ConsigneeCityName").val();
        $.ajax({
            type: "Post",
            url: '/AWBBatch/GetCourierCharge',
            datatype: "json",
            data: {
                CustomerRateTypeID: CustomerRateTypeID, CustomerId: CustomerId, MovementId: MovementId, ProductTypeID: ProductTypeID, PaymentModeId: PaymentModeId, Weight: Weight, CountryName: CountryName, CityName: CityName
            },
            success: function (response) {

                if (response != null) {
                    if ($('#CustomerRateTypeID').val() != response.CustomerRateTypeID) {
                        $('#CustomerRateTypeID').val(response.CustomerRateTypeID);
                        $('#CustomerRateType').val(response.CustomerRateType);
                        $('#h2ratetype').html(response.CustomerRateType);
                    }
                    $('#CourierCharge').val(response.CourierCharge);
                    CalculateTax();
                }
                else {
                    $('#CustomerRateTypeID').val(0);
                    $('#CustomerRateType').val(0);
                    $('#h2ratetype').html('' );
                    $('#CourierCharge').val(0);
                    CalculateTax();
                }
            }
        });
    }
    $(document).ready(function () {
        //$('#CustomerRateType').change(function () {
        //    if ($('#CustomerRateType').val() == '') {
        //        $('#CustomerRateTypeID').val(0);
        //    }
        //    else if ($('#CustomerRateType').val() != $('#CustomerRateTypeID').attr('label')) {
        //        $('#CustomerRateType').val('');
        //        $('#CustomerRateTypeID').val(0);
        //    }
        //    getCourierCharge();
        //});

     
        $("#FAgentName").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '/AWBBatch/GetForwardingAgent',
                    datatype: "json",
                    data: {
                        term: request.term
                    },
                    success: function (data) {
                        response($.map(data, function (val, item) {
                            return {
                                label: val.AgentName,
                                value: val.FAgentID

                            }
                        }))
                    }
                })
            },
            minLength: 1,
            autoFocus: false,
            focus: function (event, ui) {
                $('#FAgentName').val(ui.item.label);
                $('#FAgentID').val(ui.item.value);
                $('#FAgentID').attr('label', ui.item.label);

            },
            select: function (e, i) {
                e.preventDefault();
                $('#FAgentName').val(i.item.label);
                $('#FAgentID').val(i.item.value);
                $('#FAgentID').attr('label', i.item.label);
            }
        });
        $("#FAgentName").change(function () {
            if ($("#FAgentName").val() == '') {
                $('#FAgentID').val(0);
                $('#FAgentID').attr('label', '');
            }
            else if ($("#FAgentName").val() != $('#FAgentID').attr('label')) {
                $('#FAgentID').val(0);
                $('#FAgentID').attr('label', '');
            }
            getCourierCharge();
        });


        $("#Description").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '/AWBBatch/GetTypeofGoods',
                    datatype: "json",
                    data: {
                        term: request.term
                    },
                    success: function (data) {
                        response($.map(data, function (val, item) {
                            return {
                                label: val.TypeOfGood1,
                                value: val.TypeOfGood1

                            }
                        }))
                    }
                })
            },
            minLength: 1,
            autoFocus: false,
            focus: function (event, ui) {
                $('#Description').val(ui.item.value);

            },
            select: function (e, i) {
                e.preventDefault();
                $('#Description').val(i.item.value);
            }
        });

        //Courier charge call
        $('#customer').change(function () {
            getCourierCharge();
        });
        $('#ProductTypeID').change(function () {
            getCourierCharge();
        });
        $('#PaymentModeId').change(function () {
            if ($('#PaymentModeId').attr('readonly') == 'readonly') {
                $('#PaymentModeId').val($('#PaymentModeId').attr('paymentid'));
            }
            else
                getCourierCharge();
        });
        $('#Weight').change(function () {
            $('#VerifiedWeight').val($('#Weight').val());
            getCourierCharge();
        });
        $('#DeliveryLocation').change(function () {
            if ($('#OriginCountry').val() != $('#BranchCountry').val()) {
                $('#MovementTypeID').val(3).trigger('change');
            }
            else if ($('#DeliveryCity').val() == $('#BranchCity').val()) {
                $('#MovementTypeID').val(1).trigger('change');
            }
            else if ($('#DeliveryCity').val() != $('#BranchCity').val()) {
                $('#MovementTypeID').val(2).trigger('change');
            }
            getCourierCharge();

        });
        $('#MovementTypeID').change(function () {
            getCourierCharge();
        });

        $('#FagentID').change(function () {
            getCourierCharge();
        })

        $('#PickupLocation').change(function () {
            if ($('#OriginCountry').val() != $('#BranchCountry').val()) {
                $('#MovementTypeID').val(3).trigger('change');
            }
            if ($('#MovementTypeID').val() == 3) {
                getCourierCharge();
            }
        });



    });
</script>
<script type="text/javascript">

    function calculationspotrate() {
        var _spotrate = $('#SpotRate').val();
        var _margin = $('#MarginPercent').val();
        var _manifestweight = $('#VerifiedWeight').val();
        if (_spotrate == '')
            _spotrate = 0;

        if (_margin == '')
            _margin = 0;

        if (_manifestweight == '')
            _manifestweight == 0;

        var totalrate = parseFloat(_manifestweight) * parseFloat(_spotrate);

        var salesrate = parseFloat(totalrate);
        var couriercharge = parseFloat(totalrate) / (1 - (parseFloat(_margin) / 100.00));
        if ((parseFloat(_spotrate) > 0) && parseFloat(_margin) > 0) {
            $('#CourierCharge').val(parseFloat(couriercharge).toFixed(@_decimal));
        }

        
    }

    $(document).ready(function () {
        $('#ConsignorCountryName').autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "@Url.Action("GetCountryList", "ZoneChart")",
                    data: { SearchText: request.term },
                    dataType: "json",
                    type: "GET",
                    success: function (data) {
                        response($.map(data, function (val, item) {
                            return {
                                label: val.CountryName,
                                value: val.CountryName
                            }
                        }))
                    }
                });
            },
            minLength: 1,
            autoFocus: false,
            select: function (event, ui) {

                $('#ConsignorCountryName').val(ui.item.label);
                $('#ConsignorCountryName').attr('label',ui.item.label);
                $('#PickupLocation').val(ui.item.label);
                //$('#LocationName1').attr('placeid', ui.item.value);
                //$('#PLACEID1').val(ui.item.value)

            },
            focus: function (event, ui) {
                event.preventDefault();
                $('#ConsignorCountryName').val(ui.item.label);
                $('#ConsignorCountryName').attr('label', ui.item.label);
                $('#PickupLocation').val(ui.item.label);

            }
          });
        $('#ConsignorCityName').autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "@Url.Action("GetCityList", "ZoneChart")",
                    data: { SearchText: request.term },
                    dataType: "json",
                    type: "GET",
                    success: function (data) {
                        response($.map(data, function (val, item) {
                            return {
                                label: val.City,
                                value: val.City,
                                Country:val.CountryName
                            }
                        }))
                    }
                });
            },
            minLength: 1,
            autoFocus: false,
            select: function (event, ui) {
                event.preventDefault();
                $('#ConsignorCityName').val(ui.item.label);
                $('#ConsignorCityName').attr('label', ui.item.label);
                  $('#ConsignorCountryName').val(ui.item.Country);
                //  $('#PickupLocation').val(ui.item.Country);

            },
            focus: function (event, ui) {
                $('#ConsignorCityName').val(ui.item.label);
                $('#ConsignorCityName').attr('label', ui.item.label);
                $('#ConsignorCountryName').val(ui.item.Country);
              //  $('#PickupLocation').val(ui.item.Country);

            }
          });


        $('#ConsignorLocationName').autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "@Url.Action("GetLocationList", "ZoneChart")",
                    data: { SearchText: request.term },
                    dataType: "json",
                    type: "GET",
                    success: function (data) {
                        response($.map(data, function (val, item) {
                            return {
                                label: val.Location,
                                value: val.Location,
                                City: val.CityName,
                                Country: val.CountryName
                            }
                        }))
                    }
                })
            },
            minLength: 1,
            autoFocus: false,
            select: function (e, ui) {
                e.preventDefault();
                $('#ConsignorLocationName').val(ui.item.label);
                $('#ConsignorLocationName').attr('label', ui.item.label);
                    $('#ConsignorCityName').val(ui.item.City);
                    $('#ConsignorCountryName').val(ui.item.Country);
                    $('#PickupLocation').val(ui.item.Country);
                return false;
            },
                focus: function (event, ui) {
                    $('#ConsignorLocationName').val(ui.item.label);
                    $('#ConsignorLocationName').attr('label', ui.item.label);
                    $('#ConsignorCityName').val(ui.item.City);
                    $('#ConsignorCountryName').val(ui.item.Country);
                    $('#PickupLocation').val(ui.item.Country);
                return false;
            }
          });


        $('#ConsigneeCountryName').autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "@Url.Action("GetCountryList", "ZoneChart")",
                    data: { SearchText: request.term },
                    dataType: "json",
                    type: "GET",
                    success: function (data) {
                        response($.map(data, function (val, item) {
                            return {
                                label: val.CountryName,
                                value: val.CountryName
                            }
                        }))
                    },
                    error: function (x, y, z) {
                        alert('error');
                    }
                });
            },
            minLength: 1,
            autoFocus: false,
            select: function (e, ui) {
                e.preventDefault();
                $('#ConsigneeCountryName').val(ui.item.label);
                $('#ConsigneeCountryName').attr('label',ui.item.label);
                $('#DeliveryLocation').val(ui.item.label);
                return false;
            },
            focus: function (event, ui) {
                $('#ConsigneeCountryName').val(ui.item.label);
                $('#ConsigneeCountryName').attr('label', ui.item.label);
                $('#DeliveryLocation').val(ui.item.label);
                return false;
            }
          });
        $('#ConsigneeCityName').autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "@Url.Action("GetCityList", "ZoneChart")",
                    data: {
                        SearchText: request.term
                    },
                    dataType: "json",
                    type: "GET",
                    success: function (data) {
                        response($.map(data, function (val, item) {
                            return {
                                label: val.City,
                                value: val.City,
                                Country:val.CountryName
                            }
                        }))
                    }
                });
            },
            minLength: 1,
            autoFocus: false,
            select: function (event, ui) {
                event.preventDefault();
                $('#ConsigneeCityName').val(ui.item.label);
                $('#ConsigneeCityName').attr('label',ui.item.label);
                  $('#ConsigneeCountryName').val(ui.item.Country);
                  $('#DeliveryLocation').val(ui.item.Country);
                return false;
            },
            focus: function (event, ui) {
                $('#ConsigneeCityName').val(ui.item.label);
                $('#ConsigneeCityName').attr('label', ui.item.label);
                $('#ConsigneeCountryName').val(ui.item.Country);
                $('#DeliveryLocation').val(ui.item.Country);

                return false;
            }
          });


        $('#ConsigneeLocationName').autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "@Url.Action("GetLocationList", "ZoneChart")",
                    data: { SearchText: request.term },
                    dataType: "json",
                    type: "GET",
                success: function (data) {
                response($.map(data, function (val, item) {
                    return {
                        label: val.Location,
                        value: val.Location,
                        City: val.CityName,
                        Country: val.CountryName
                    }
                }))
            }
            })
            },
            minLength: 1,
            autoFocus: false,
            select: function (e, ui) {
                e.preventDefault();
                $('#ConsigneeLocationName').val(ui.item.label);
                $('#ConsigneeLocationName').attr('label',ui.item.label);
                    $('#ConsigneeCityName').val(ui.item.City);
                    $('#ConsigneeCountryName').val(ui.item.Country);
                $('#DeliveryLocation').val(ui.item.Country);
                getMovementType();
                return false;
            },
                focus: function (event, ui) {
                    $('#ConsigneeLocationName').val(ui.item.label);
                    $('#ConsigneeLocationName').attr('label', ui.item.label);
                    $('#ConsigneeCityName').val(ui.item.City);
                    $('#ConsigneeCountryName').val(ui.item.Country);
                    $('#DeliveryLocation').val(ui.item.Country);
                    getMovementType();
                return false;
            }
          });
        //$('#ConsignorLocationName').change(function () {

        //    if ($('#ConsignorLocationName').val() != '') {
        //        if ($('#ConsignorLocationName').val().trim().toLowerCase() != $('#ConsignorLocationName').attr('label').trim().toLowerCase()) {
        //            $('#ConsignorLocationName').val('');
        //            $('#ConsignorCityName').val('');
        //            $('#ConsignorCountryName').val('');
        //            $('#ConsignorLocationName').attr('label', '');
        //            $('#ConsignorLocationName').focus();
        //        }
        //        else {
        //            getMovementType();
        //        }
        //    }
        //});

        $('#ConsignorCountryName').change(function () {
            if ($('#ConsignorCountryName').val() != '') {
                if ($('#ConsignorCountryName').val().trim().toLowerCase() != $('#ConsignorCountryName').attr('label').trim().toLowerCase()) {
                    $('#ConsignorCountryName').val('');
                    $('#ConsignorCountryName').attr('label', '');
                    $('#ConsignorCountryName').focus();
                }
                else {
                    getMovementType();
                }
            }
        });

        $('#ConsignorCityName').change(function () {
            if ($('#ConsignorCityName').val() != '') {
                if ($('#ConsignorCityName').val().trim().toLowerCase() != $('#ConsignorCityName').attr('label').trim().toLowerCase()) {
                    $('#ConsignorCityName').val('');
                    $('#ConsignorCountryName').val('');
                    $('#ConsignorCityName').attr('label', '');
                    $('#ConsignorCityName').focus();
                }
                else {
                    getMovementType();
                }
            }
        });
        //$('#ConsigneeLocationName').change(function () {
        //    if ($('#ConsigneeLocationName').val() != '') {
        //        if ($('#ConsigneeLocationName').val().trim().toLowerCase() != $('#ConsigneeLocationName').attr('label').trim().toLowerCase()) {
        //            $('#ConsigneeLocationName').val('');
        //            $('#ConsigneeCountryName').val('');
        //            $('#ConsigneeCityName').val('');
        //            $('#ConsigneeLocationName').attr('label', '');
        //            $('#ConsigneeLocationName').focus();
        //        }
        //        else {
        //            getMovementType();
        //        }
        //    }
        //});

        $('#ConsigneeCountryName').change(function () {
            if ($('#ConsigneeCountryName').val() != '') {
                if ($('#ConsigneeCountryName').val().trim().toLowerCase() != $('#ConsigneeCountryName').attr('label').trim().toLowerCase()) {
                    $('#ConsigneeCountryName').val('');
                    $('#ConsigneeCountryName').attr('label', '');
                    $('#ConsigneeCountryName').focus();
                }
                else {
                    getMovementType();
                }
            }
        });

        $('#ConsigneeCityName').change(function () {
            if ($('#ConsigneeCityName').val() != '') {
                if ($('#ConsigneeCityName').val().trim().toLowerCase() != $('#ConsigneeCityName').attr('label').trim().toLowerCase()) {
                    $('#ConsigneeCityName').val('');
                    $('#ConsigneeCountryName').val('');
                    $('#ConsigneeCityName').attr('label', '');
                    $('#ConsigneeCityName').focus();
                }
                else {
                    getMovementType();
                }
            }
        });
        @*$('#PickupLocation').autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "@Url.Action("GetCountryList", "ZoneChart")",
                    data: { SearchText: request.term },
                    dataType: "json",
                    type: "GET",
                    success: function (data) {
                        response($.map(data, function (val, item) {
                            return {
                                label: val.CountryName,
                                value: val.CountryName
                            }
                        }))
                    }
                });
            },
            minLength: 1,
            autoFocus: false,
            select: function (event, ui) {
                event.preventDefault();
                $('#PickupLocation').val(ui.item.label);
                $('#PickupLocation').attr('label',ui.item.label);
                return false;
            },
            focus: function (event, ui) {
                $('#PickupLocation').val(ui.item.label);
                $('#PickupLocation').attr('label', ui.item.label);
                return false;
            }
        });*@

        @*$('#DeliveryLocation').autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "@Url.Action("GetCountryList", "ZoneChart")",
                    data: { SearchText: request.term },
                    dataType: "json",
                    type: "GET",
                    success: function (data) {
                        response($.map(data, function (val, item) {
                            return {
                                label: val.CountryName,
                                value: val.CountryName
                            }
                        }))
                    }
                });
            },
            minLength: 1,
            autoFocus: false,
            select: function (event, ui) {
                event.preventDefault();
                $('#DeliveryLocation').val(ui.item.label);
                $('#DeliveryLocation').attr('label',ui.item.label);
                return false;
            },
            focus: function (event, ui) {
                $('#DeliveryLocation').val(ui.item.label);
                $('#DeliveryLocation').attr('label', ui.item.label);
                return false;
            }
          });
        $('#PickupLocation').change(function () {
            if ($('#PaymentModeId').val() == 5) //prepaid
            {
                if ($('#DeliveryCountry').val() != '' && $('#DeliveryCountry').val() != $('#DeliveryCountry').attr('awbcountry')) {
                    $.notify('Delivery country not matched with awb paid Country!');
                    $('#DeliveryLocation').val('');
                    $('#DeliveryLocation').focus();
                }
            }
            else {
                if ($('#PickupLocation').val() != '') {
                    if ($('#PickupLocation').val().trim().toLowerCase() != $('#PickupLocation').attr('label').trim().toLowerCase()) {
                        $('#PickupLocation').val('');
                        $('#PickupLocation').attr('label', '');
                        $('#PickupLocation').focus();
                    }
                    else {
                        getMovementType();
                        getCourierCharge();
                    }
                }

            }
        });*@
        //$('#DeliveryLocation').change(function () {

        //    if ($('#PaymentModeId').val() == 5) //prepaid
        //    {
        //        if ($('#DeliveryCountry').val() != '' && $('#DeliveryCountry').val() != $('#DeliveryCountry').attr('awbcountry')) {
        //            $.notify('Delivery coutry not matched with awb paid Country!');
        //            $('#DeliveryLocation').val('');
        //            $('#DeliveryLocation').focus();
        //        }
        //    }
        //    else {
        //        if ($('#DeliveryLocation').val() != '') {
        //            if ($('#DeliveryLocation').val().trim().toLowerCase() != $('#DeliveryLocation').attr('label').trim().toLowerCase()) {
        //                $('#DeliveryLocation').val('');
        //                $('#DeliveryLocation').attr('label', '');
        //                $('#DeliveryLocation').focus();
        //            }
        //            else {
        //                getMovementType();
        //                getCourierCharge();
        //            }
        //        }
        //    }

        //})
        $('#ShipmentModeID').change(function () {
            $.ajax({
                type: "POST",
                url: "/AWB/GetMaxAWBNo",
                datatype: "Json",
                data: {
                    ShipmentModeID: $('#ShipmentModeID').val() },
                success: function (data) {
                    $("#HAWBNo").val(data);
                }
            });
        })
        $("#AWBAutoGenerated").click(function () {
            if ($("#AWBAutoGenerated").is(':checked')) {
                $('#HAWBNo').attr('readonly', 'readonly');
                $.ajax({
                    type: "POST",
                    url: "/AWB/GetMaxAWBNo",
                    datatype: "Json",
                    data: {
                        ShipmentModeID: $('#ShipmentModeID').val()
                    },
                    success: function (data) {
                        $("#HAWBNo").val(data);
                    }
                });
            }
            else {

                $('#HAWBNo').removeAttr('readonly');
                $('#HAWBNo').val('');
                $('#HAWBNo').focus();
            }
        });

        $("#Pieces").keypress(function (e) {
            return RestrictSpaceSpecial1(e);
        })
        $("#Pieces").change(function () {
            var x = $(this);
            var str = $(this).val().trim();
            if (str != '' && str != null) {
                $(this).val($(this).val().trim());
                str = $(this).val();
                //console.log(str);
                $(this).val(parseFloat(str).toFixed(0));
            }
            else {
                $(this).val(parseFloat(0).toFixed(0));
            }

        });
        $("#Weight").keypress(function (e) {
            return RestrictSpaceSpecial(e);
        })
        $("#Weight").change(function () {
            var x = $(this);
            var str = $(this).val().trim();
            if (str != '' && str != null) {
                $(this).val($(this).val().trim());
                str = $(this).val();
                //console.log(str);
                $(this).val(parseFloat(str).toFixed(3));
            }
            else {
                $(this).val(parseFloat(0).toFixed(3));
            }

        });
    });

</script>




@using (Html.BeginForm("Create", "AWB", FormMethod.Post, new { @class = "needs-validation ", @novalidate = "novalidate", @id = "quickAWB" }))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true, "", new { @class = "needs-validation" })
    <div class="card">
        <div class="card-body">
            <div class="row mb-3">
                <div class="col-md-6">
                    <h4 class="card-title mb-2 mt-1">
                        Airway Bill Details
                        @{
                            if (Model.ReturnedtoConsignor == "")
                            {
                            <a target="_blank" href="/CustomerInvoice/Create?id=@Model.InvoiceId" id="h2jobcode" style="color:blue" class="ml-10">@Model.InvoiceStatus @Model.DRRNo</a>
                            }
                            else
                            {
                                <span style="color:red"> @Model.ReturnedtoConsignor </span>
                            }
                            }
                    </h4>                                  

                    

                </div>
                <div class="col-md-6 text-right mt-2">
                    @{
                        if (Model.ReturnedtoConsignor == "" || Model.ReturnedtoConsignor==null )
                        {
                            <button type="submit" id="btnsave" class="btn btn-success">Save</button>
                        }
                        else
                        {
                            <button type="submit" class="btn btn-success" disabled>Save</button>
                        }
                    }
                    <a href="/AWB/Index/0" class="btn btn-secondary">Cancel</a>





                    <div id="divothermenu" class="btn-group hide">

                        <span class="btn btn-primary"><i class="bx bx-cog bx-spin me-2"></i>Sub Menu</span>
                        <button type="button" class="btn btn-primary dropdown-toggle-split border_right" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="mdi mdi-chevron-down"></i>
                        </button>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" href="/AWB/Create?id=0">New AWB</a>
                            <a class="dropdown-item" href="/AWB/Index">AWB List</a>
                            <a class="dropdown-item" href="/AWB/AWBTimeline?id=@Model.InScanID">Time Line</a>

                            @*<a class="dropdown-item" href="@Url.Action("AWBPrint", new { id = Model.InScanID })">Print Airway Bill</a>*@
                            @*<a class="dropdown-item" onclick="ShowNotification()">Customer Notification</a>
                <a class="dropdown-item" onclick="ShowStaffNotes()">Staff Notes</a>*@

                            @*<a class="dropdown-item" href="@Url.Action("GenerateInvoice", new { id = Model.InScanID })">Invoice Reference</a>*@


                        </div>
                    </div>
                    <div class="btn-group hide" id="divothermenu1">
                        <span class="btn btn-pink"><i class="mdi mdi-printer font-size-14 me-2"></i>Print</span>
                        <button type="button" class="btn btn-pink dropdown-toggle-split border_right" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="mdi mdi-chevron-down"></i>
                        </button>
                        <div class="dropdown-menu" id="divprintmenu">
                            <a class="dropdown-item" href="/AWB/AWBPrintReport?id=@Model.InScanID">AWB Print</a>
                            @*<a class="dropdown-item" href="/Print/ConsignmentRegister">Consignment Register</a>*@
                        </div>
                    </div>

                </div><!-- /btn-group -->
                </div>
             
            @Html.AntiForgeryToken()
            @Html.ValidationSummary(true, "", new { @class = "text-danger" })
            <div id="validations" style="color:red;margin-left:7px;display:none">* Please fill mandatory fields</div>
            <input type="hidden" id="IsAvailable" value="0" />


            @*<div class="row no-margin" style="padding-top: 10px">
                    <div class="col-md-12">
                        <h3 style="color:white">Customer Details</h3><hr />
                    </div>
                </div>*@
        <div class="row no_margin">
            <div class="col-md-2">
                <div class="flexTitle">
                    <label class="col-form-label required" title="Shipment Mode">Shipping Mode</label>
                    <div class="checkboxdesign no-padding  text-right" style="float:right;">
                        @Html.CheckBox("AWBAutoGenerated", new { @name = "AWBAutoGenerated", @style = "" }) &nbsp;
                        <label class="col-form-label" style="color: #00a65a !important;padding-left: 0 !important">Auto</label>
                    </div>
                </div>
                @Html.DropDownListFor(model => model.ShipmentModeID, new SelectList(@ViewBag.ShipmentMode, "ID", "ShipmentMode"), "Select", new { @class = "form-select" })
            </div>
            <div class="col-md-2">

                <label class="col-form-label">Airway Bill Date</label>
                <div class="docs-datepicker">
                    <div class="input-group">
                        <input type="text" class="form-control docs-date" name="TransactionDate" id="TransactionDate" value="@Model.TransactionDate.ToShortDateString()" autocomplete="off">
                        <button type="button"
                                class="btn btn-secondary docs-datepicker-trigger"
                                disabled>
                            <i class="mdi mdi-calendar" aria-hidden="true"></i>
                        </button>
                    </div>
                    <div class="docs-datepicker-container"></div>
                </div>
                <div class="invalid-feedback">
                    AWB Date Required
                </div>


            </div>
            <div class="col-md-2">
                <input type="hidden" id="hdnCustomerType" value="0" />
                @Html.HiddenFor(model => model.InScanID)
                @Html.HiddenFor(model => model.AWBFOCZero)
                @Html.HiddenFor(model => model.BranchID)
                @Html.HiddenFor(model => model.DepotID)
                @Html.HiddenFor(model => model.InvoiceId)
                @Html.HiddenFor(model => model.AWBProcessed)
                @Html.HiddenFor(model => model.AcCompanyID)
                @Html.HiddenFor(model => model.UserID)
                @Html.HiddenFor(model => model.CourierStatusId)
                @Html.HiddenFor(model => model.StatusTypeId)
                @Html.HiddenFor(model => model.CustomerID)
                @Html.HiddenFor(model => model.CASHCustomerId)
                @Html.HiddenFor(model => model.CODCustomerID)
                @Html.HiddenFor(model => model.CODCustomerName)
                @Html.HiddenFor(model => model.CASHCustomerName)
                @Html.HiddenFor(model => model.FOCCustomerName)
                @Html.HiddenFor(model => model.FOCCustomerID)
                @Html.HiddenFor(model => model.DefaultFAgentID)
                @Html.HiddenFor(model => model.DefaultFAgentName)
                @Html.HiddenFor(model => model.ParentAWBNo)
                @Html.HiddenFor(model => model.ParentInScanID)
                @Html.HiddenFor(model => model.DRRID)
                @Html.HiddenFor(model => model.DRRProcess, new { status = Model.DRRProcess })
                <input type="hidden" id="txtAWBProcessed" value="" required />
                <input type="hidden" id="CBMbasedCharges" value="0" />
                <input type="hidden" id="VolumeMetricBased" value="0" />
                <input type="hidden" id="UserType" value="@ViewBag.UserType" />
                <div class="flex">
                    <div class="input-group">
                        <label class="col-form-label text-lightblue">Airway Bill No.</label>

                        @*@if (@Model.ParentAWBNo == "" || @Model.ParentAWBNo == null)
                        {
                            <div class="input-group-sm mt-16 masterplus" id="aImportAWB" onclick="showimportawb()">
                                <i class="mdi mdi-dots-horizontal" aria-hidden="true"></i>
                            </div>
                        }
                        else
                        {
                            <div class="input-group-sm mt-16 masterplus" onclick="showimportawb()" id="aImportAWB">
                                @Model.ParentAWBNo
                            </div>

                        }*@

                    </div>
                </div>
                @*<label class="col-form-label required">Airway Bill No.</label>*@
                @if (@Model.InScanID == 0)
                {@Html.TextBoxFor(model => model.HAWBNo, new { @class = "form-control txttargetcaps", @required = "true", @maxlength = 20 }) }

            else
            {
                @Html.TextBoxFor(model => model.HAWBNo, new { @class = "form-control txttargetcaps", @Disabled = "disabled" })
            }
                <div class="invalid-feedback">
                    AWB No. Required
                </div>
            </div>

            <div class="col-md-2 hide">
                <label class="col-form-label">Pickup Request No.</label>
                @Html.TextBoxFor(model => model.EnquiryNo, new { @class = "form-control" })
                @*@Html.DropDownListFor(model => model.EnquiryNo, new SelectList(@ViewBag.Enquiry, "EnquiryNo", "EnquiryNo"), "Select", new { @class = "form-control" })*@
            </div>
            <div class="col-md-2">
                <label class="col-form-label required">Payment Mode</label>
                @Html.DropDownListFor(model => model.PaymentModeId, new SelectList(@ViewBag.PaymentMode, "ID", "PaymentModeText"), "Select", new { @class = "form-select", @required = "true", @paymentid = Model.PaymentModeId })
                <div class="invalid-feedback">
                    Payment Mode Required
                </div>
            </div>
            <div class="col-md-4" id="divcustomer">
                <div class="flexTitle">
                    @*<label class="col-form-label required" id="">Customer</label>*@
                    <a id="lblcustomer" class="col-form-label required hyperlink">Customer <span class="red">(Alt+C)</span></a>
                    <div class="checkboxdesign no-padding text-right" style="float: right;">
                        @Html.CheckBox("CustomerandShipperSame", new { @name = "CustomerandShipperSame" }) &nbsp
                        <label class="col-form-label" style="color: #00a65a !important; padding-left: 0 !important">copy address to shipper</label>
                    </div>
                </div>

                @Html.TextBoxFor(model => model.customer, new { @class = "form-select txttarget", @required = "true" })
                <div class="invalid-feedback">
                    Select Customer Name
                </div>

            </div>
            <div class="col-md-4 hide" id="divcash">
                <label class="col-form-label">Cash Account</label>
                @Html.TextBoxFor(model => model.AcHeadName, new { @class = "form-select txttarget", @required = "true", @autocomplete = "off", @type = "search" })
                <div class="invalid-feedback">
                    Cash Account Required
                </div>
                @Html.HiddenFor(model => model.AcheadID, new { })
            </div>
        </div>

        </div>
    </div>
    <div class="card">
        <div class="card-body detailBox">
            <div class="bg_box">

                @*<div class="row no-margin">
                        <div class="col-md-3 checkboxdesign" style="padding-top: 20px">
                            @Html.CheckBox("CustomerandShipperSame", new { @name = "CustomerandShipperSame" }) &nbsp
                            <label class="headinglabel" style="font-weight:bold;color:#07a7e3!important">Copy Address from Customer</label>
                        </div>
                    </div>*@

                <div class="row">
                    <div class="col-md-6">
                        <div class="row">
                            <div class="col-md-12">
                                <h3 class="card-title mb-3 mt-2">Consignor/Shipper Details</h3><hr />
                            </div>
                            <div class="col-md-6">
                                <div class="mb-2">
                                    <label class="col-form-label text-lightblue">Consignor Name</label>
                                    @Html.TextBoxFor(model => model.shippername, new { @class = "form-select txttarget", @autocomplete = "off", @type = "search", @required = "true", @style = "", @placeholder = "Shipper Name" })
                                    <div class="invalid-feedback">
                                        Enter Consignor Name
                                    </div>
                                </div>

                            </div>
                            <div class="col-md-6">
                                <div class="mb-2">
                                    <label class="col-form-label text-lightblue">Telephone No.</label>
                                    @Html.TextBoxFor(model => model.ConsignorPhone, new { @class = "form-control text-right", @placeholder = "Telephone" })
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-2">
                                    <label class="col-form-label text-lightblue">Contact Person</label>
                                    @Html.TextBoxFor(model => model.ConsignorContact, new { @class = "form-control txttarget", @placeholder = "Contact Person" })
                                    @Html.ValidationMessageFor(model => model.ConsignorContact, "", new { @class = "text-danger", @placeholder = "Contact Person" })
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="mb-2">
                                    <label class="col-form-label text-lightblue">Mobile No.</label>
                                    @Html.TextBoxFor(model => model.ConsignorMobile, new { @class = "form-control text-right", @placeholder = "Telephone" })
                                </div>
                            </div>

                            <div class="col-md-6">
                                    <label class="col-form-label text-lightblue">Flat/Building</label>
                                    @Html.TextBoxFor(model => model.ConsignorAddress1_Building, new { @class = "form-control txttarget", @placeholder = "Flat/Building" })
                                </div>

                            <div class="col-md-6">
                                <div class="mb-2">
                                    <label class="col-form-label text-lightblue">Area/Land Mark</label>
                                    @Html.TextBoxFor(model => model.ConsignorAddress2_Street, new { @class = "form-control txttarget", @placeholder = "Street" })
                                </div>
                            </div>


                            <div class="col-md-6">
                                <div class="mb-2">
                                    <label class="col-form-label text-lightblue">Pincode</label>
                                    @Html.TextBoxFor(model => model.ConsignorAddress3_PinCode, new { @class = "form-control text-right txttargetcaps", @placeholder = "PinCode" })
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="mb-2">
                                    <div class="flex">
                                        <div class="input-group">
                                            <label class="col-form-label text-lightblue">Origin Location<span class="red">(Alt+L)</span></label>
                                            <div class="input-group-sm mt-16 masterplus " id="lblconsignorLocation">
                                                <i class="mdi mdi-dots-horizontal" aria-hidden="true"></i>
                                            </div>
                                        </div>
                                    </div>
                                    @Html.TextBoxFor(model => model.ConsignorLocationName, new { @class = "form-select txttarget autocomplete", @placeholder = "Location", @label = "" })
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-2">
                                    <label class="col-form-label text-lightblue">Origin City</label>
                                    @Html.TextBoxFor(model => model.ConsignorCityName, new { @class = "form-select txttarget", @required = "true", @label = "" })
                                    <div class="invalid-feedback">
                                        Select Origin City
                                    </div>
                                    @*<input class="form-control" id="ConsignorCityName" name="ConsignorCityName" type="text" readonly />*@
                                    @*@Html.DropDownListFor(model => model.origincity, new SelectList(@ViewBag.City, "CityID", "City"), "Select", new { @class = "form-control" })*@
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-2">
                                    <label class="col-form-label text-lightblue">Origin Country</label>
                                    @Html.TextBoxFor(model => model.ConsignorCountryName, new { @class = "form-select txttarget", @required = "true", @label = "" })
                                    <div class="invalid-feedback">
                                        Select Origin Country
                                    </div>
                                    @*<input class="form-control" id="ConsignorCountryName" name="ConsignorCountryName" type="text" readonly />*@
                                    @*@Html.DropDownListFor(model => model.origincountry, new SelectList(@ViewBag.Country, "CountryID", "CountryName"), "Select", new { @class = "form-control" })*@
                                </div>
                            </div>

                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="col-md-12">
                            <h3 class="card-title mb-3 mt-2">Receiver/Consignee Details</h3><hr />
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="flexTitle">
                                    <label class="col-form-label text-lightpink">Consignee Name</label>
                                    <div class="checkboxdesign no-padding text-right" style="float:right">
                                        @Html.CheckBox("ShowAllConsignee", new { @name = "ShowAllConsignee", @style = "margin-bottom:5px;margin-right: 0px !important;" }) &nbsp
                                        <label class="col-form-label" style="color:#07a7e3!important;padding-left: 0!important">All</label>
                                    </div>
                                </div>
                                @Html.TextBoxFor(model => model.Consignee, new { @class = "form-control txttarget", @autocomplete = "off", @type = "search", @required = "true" })
                                <div class="invalid-feedback">
                                    Consignee Name Required
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-2">
                                    <label class="col-form-label text-lightpink">Telephone No.</label>
                                    @Html.TextBoxFor(model => model.ConsigneePhone, new { @class = "form-control text-right" })
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-2">
                                    <label class="col-form-label text-lightpink">Contact Person</label>
                                    @Html.TextBoxFor(model => model.ConsigneeContact, new { @class = "form-control txttarget" })
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-2">
                                    <label class="col-form-label text-lightpink">Mobile No.</label>
                                    @Html.TextBoxFor(model => model.ConsigneeMobile, new { @class = "form-control text-right" })
                                </div>
                            </div>
                            <div class="col-md-6">
                                    <div class="mb-2">
                                        <label class="col-form-label text-lightpink">Flat/building</label>
                                        @Html.TextBoxFor(model => model.ConsigneeAddress1_Building, new { @class = "form-control txttarget" })
                                    </div>
                                </div>
                            <div class="col-md-6">
                                <div class="mb-2">
                                    <label class="col-form-label text-lightpink">Area/Land Mark</label>
                                    @Html.TextBoxFor(model => model.ConsigneeAddress2_Street, new { @class = "form-control txttarget" })
                                </div>
                            </div>



                            <div class="col-md-6">
                                <div class="mb-2">
                                    <label class="col-form-label text-lightpink">Pincode</label>
                                    @Html.TextBoxFor(model => model.ConsigneeAddress3_PinCode, new { @class = "form-control txttargetcaps" })
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="mb-2">
                                    <div class="flex">
                                        <div class="input-group">
                                            <label class="col-form-label text-lightpink">Destination Location<span class="red">(Alt+N)</span></label>
                                            <div class="input-group-sm mt-16 masterplus " id="lblconsigneeLocation">
                                                <i class="mdi mdi-dots-horizontal" aria-hidden="true"></i>
                                            </div>
                                        </div>
                                    </div>
                                    @Html.TextBoxFor(model => model.ConsigneeLocationName, new { @class = "form-select txttarget autocomplete", @label = "" })
                                    @*<input class="form-control  " id="ConsigneeLocationName" name="ConsigneeLocationName" onFocus="geolocate()" type="text" />*@
                                    @*@Html.TextBoxFor(model => model.destlocation, new { @class = "form-control txttarget" })*@
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-2">
                                    <label class="col-form-label text-lightpink">Destination City</label>
                                    @Html.TextBoxFor(model => model.ConsigneeCityName, new { @class = "form-select txttarget", @required = "true", @label = "" })
                                    <div class="invalid-feedback">
                                        Select Destination City
                                    </div>
                                    @*<input class="form-control" id="ConsigneeCityName" name="CityName" type="text" onFocus="geoCitylocate()" />*@
                                    @*@Html.DropDownListFor(model => model.destinationCity, new SelectList(@ViewBag.City, "CityID", "City"), "Select", new { @class = "form-control" })*@
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="mb-2">
                                    <label class="col-form-label text-lightpink">Destination Country</label>
                                    @Html.TextBoxFor(model => model.ConsigneeCountryName, new { @class = "form-select txttarget", @required = "true", @label = "" })
                                    <div class="invalid-feedback">
                                        Select Destination Country
                                    </div>
                                    @*<input class="form-control" id="ConsigneeCountryName" name="ConsigneeCountryName" type="text" onFocus="geoCountrylocate()" />*@
                                    @*@Html.DropDownListFor(model => model.destinationCountry, new SelectList(@ViewBag.Country, "CountryID", "CountryName"), "Select", new { @class = "form-control" })*@
                                </div>
                            </div>
                        </div>
                    </div>
                </div>






            </div>
        </div>
    </div>
    <div class="card">
        <div class="card-body details1">
            <div class="bg_box1">

                <div class="row">
                    <div class="col-md-6">
                        <div class="col-md-12">
                            <h3 class="card-title mb-3 mt-2">Shipment Details</h3><hr />
                        </div>
                        <div class="clearfix"></div>
                        <div class="row">
                            @Html.HiddenFor(model => model.BranchLocation)
                            @Html.HiddenFor(model => model.BranchCity)
                            @Html.HiddenFor(model => model.BranchCountry)

                            @*<div class="col-md-3">
                                    <label class="col-form-label">PickUp Location</label>
                                    @Html.TextBoxFor(model => model.PickupLocation, new { @class = "form-control txttarget" })
                                    @Html.HiddenFor(model => model.PickupLocationPlaceId)
                                    @Html.HiddenFor(model => model.OriginCountry)
                                    @Html.HiddenFor(model => model.OriginCity)
                                </div>
                                <div class="col-md-3">
                                    <label class="col-form-label">Delivery Location </label>
                                    @Html.TextBoxFor(model => model.DeliveryLocation, new { @class = "form-control txttarget" })
                                    @Html.HiddenFor(model => model.DeliveryLocationPlaceId)
                                    @Html.HiddenFor(model => model.DeliveryCountry)
                                    @Html.HiddenFor(model => model.DeliveryCity)
                                </div>*@
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-2">
                                    <div class="flex">
                                        <div class="input-group">
                                            <label class="col-form-label">Description</label>
                                            <div class="input-group-sm mt-16 masterplus ItemShipment" id="">
                                                <i class="mdi mdi-plus" aria-hidden="true"></i>
                                            </div>
                                        </div>
                                    </div>

                                    @Html.TextBoxFor(model => model.Description, new { @class = "form-control txttarget", @autocomplete = "off" })
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-2">
                                            <label class="col-form-label required">Pieces</label>
                                            @Html.TextBoxFor(model => model.Pieces, new { @class = "form-control textright", @onkeypress = "return isNumberKey1(event)", @required = "true", @maxlength = 13 })
                                            <div class="invalid-feedback">
                                                Enter Pieces
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-2">
                                            <label class="col-form-label required">Weight</label>
                                            @Html.TextBoxFor(model => model.Weight, new { @class = "form-control textright3", @onkeypress = "return isNumberKey(event)", @onchange = "setThreeNumberDecimal(this)", @required = "true", @minimum = 0.1 })
                                            <div class="invalid-feedback">
                                                Enter Weight
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="mb-2">
                                    <label class="col-form-label required">Invoice.value</label>
                                    @Html.TextBoxFor(model => model.CustomsValue, new { @class = "form-control textright", @onkeypress = "return isNumberKey(event)"  })
                                    <div class="invalid-feedback">
                                        Invoice Value
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="mb-2">
                                    <label class="col-form-label required">Currency</label>
                                    @Html.DropDownListFor(model => model.CurrencyID, new SelectList(@ViewBag.Currency, "CurrencyID", "CurrencyName"), "Select", new { @class = "form-select", @required = "true" })
                                    <div class="invalid-feedback">
                                        Currency Required
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-2">
                                    <label class="col-form-label required">Movement Type</label>
                                    @Html.DropDownListFor(model => model.MovementTypeID, new SelectList(@ViewBag.Movement, "MovementID", "MovementType"), "Select", new { @class = "form-select", @required = "true" })
                                    <div class="invalid-feedback">
                                        Movement Type Required
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-2">
                                   
                                    <label class="col-form-label required">Product Type</label>
                                    @Html.DropDownListFor(model => model.ProductTypeID, new SelectList(@ViewBag.ProductType, "ProductTypeID", "ProductName"), "Select", new { @class = "form-select", @required = "true" })

                                    <div class="invalid-feedback">
                                        Product Type Required
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-2">
                                    <label class="col-form-label required">Parcel Type</label>
                                    @Html.DropDownListFor(model => model.ParcelTypeID, new SelectList(@ViewBag.parceltype, "ID", "ParcelType1"), "Select", new { @class = "form-select", @required = "true" })
                                    <div class="invalid-feedback">
                                        Parcel Type Required
                                    </div>

                                </div>
                            </div>
                            <!--<div class="col-md-4">
    <div class="mb-2">
        <label class="col-form-label required"> Rate Type</label>-->
                            @*@Html.DropDownListFor(model => model.CustomerRateTypeID, new SelectList(@ViewBag.customerrate, "CustomerRateTypeID", "CustomerRateType1"), "Select", new { @class = "form-control", @required = "true" })*@
                            <!--</div>
    </div>-->
                            <div class="col-md-12">
                                <h3 class="card-title mb-3 mt-2">Forwarding Agent Details</h3><hr />
                            </div>
                            <div class="col-md-4">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="mb-2">
                                            <label class="col-form-label required">Length</label>
                                            @Html.TextBoxFor(model => model.CBMLength, new { @class = "form-control textright0", @onchange= "calvolumeweight()", @onkeypress = "return isNumberKey1(event)", @maxlength = 5 })
                                            <div class="invalid-feedback">
                                                Enter Pieces
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="mb-2">
                                            <label class="col-form-label required">Width</label>
                                            @Html.TextBoxFor(model => model.CBMWidth, new { @class = "form-control textright0", @onchange = "calvolumeweight()", @onkeypress = "return isNumberKey(event)", @maxlength = 5 })
                                            <div class="invalid-feedback">
                                                Enter Weight
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="mb-2">
                                            <label class="col-form-label required">Height</label>
                                            @Html.TextBoxFor(model => model.CBMHeight, new { @class = "form-control textright0", @onchange = "calvolumeweight()", @onkeypress = "return isNumberKey(event)", @maxlength = 5 })
                                            <div class="invalid-feedback">
                                                Enter Height
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-2">
                                    <div class="flexTitle">
                                        <label class="col-form-label required" title="Verified Weight">Verified. Wt.</label>
                                        <span style="color:red;text-align:right" id="lblvolumeweight"></span>
                                    </div>
                                    
                                    @Html.TextBoxFor(model => model.VerifiedWeight, new { @class = "form-control textright3", @onkeypress = "return isNumberKey(event)", @onchange = "getCourierCharge()", @minimum = 0.1, @title = "Verified Weight" })
                                    <div class="invalid-feedback">
                                        Enter Verified Weight
                                    </div>

                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-2">
                                            <label class="col-form-label required" title="Margin">Spot Rate</label>
                                            @Html.TextBoxFor(model => model.SpotRate, new { @class = "form-control textright", @onkeypress = "return isNumberKey(event)", @onchange = "getCourierCharge()", @minimum = 0.1, @title = "Spot Rate" })
                                            <div class="invalid-feedback">
                                                Enter Spot Rate
                                            </div>

                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-2">
                                            <label class="col-form-label required" title="Margin">Margin%</label>
                                            @Html.TextBoxFor(model => model.MarginPercent, new { @class = "form-control textright", @onkeypress = "return isNumberKey(event)", @onchange = "getCourierCharge()", @minimum = 0.1, @title = "Margin Percentage" })
                                            <div class="invalid-feedback">
                                                Enter Margin Percent
                                            </div>

                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-2">
                                    <label class="col-form-label" id="lblfagent">Forwarding Agent</label>
                                    @Html.DropDownListFor(model => model.FagentID, new SelectList(@ViewBag.FAgent, "SupplierID", "SupplierName"), "Select", new { @class = "form-select" })
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-2">
                                    <label class="col-form-label" id="lblfagentrate">Forw. Rate</label>
                                    @Html.TextBoxFor(model => model.ForwardingCharge, new { @class = "form-control textright" })
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-2">
                                    <label class="col-form-label" id="lblfagentno">Forw.Agnt.No</label>
                                    @Html.TextBoxFor(model => model.FAWBNo, new { @class = "form-control" })
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="mb-2">
                                    <label class="col-form-label required" title="Manifest Weight/Verified Weight">Manifest Weight</label>
                                    @Html.TextBoxFor(model => model.ManifestWeight, new { @class = "form-control textright3", @onkeypress = "return isNumberKey(event)", @minimum = 0.1, @title = "Manifest Weight/Verified Weight" })
                                    <div class="invalid-feedback">
                                        Enter Manifest Weight
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-8">
                                <div class="mb-2">
                                    <label class="col-form-label">Remarks</label>
                                    @Html.TextBoxFor(model => model.remarks, new { @class = "form-control txttarget" })
                                </div>
                            </div>
                            @*<div class="col-md-3">
            <label class="col-form-label">PickUp Sub Location</label>
            @Html.TextBoxFor(model => model.PickupSubLocality, new { @class = "form-control", @readonly = "readonly" })
        </div>
        <div class="col-md-3">
            <div class="mb-2">
                <label class="col-form-label">Delivery Sub Location</label>
                @Html.TextBoxFor(model => model.DeliverySubLocality, new { @class = "form-control", @readonly = "readonly" })
            </div>
        </div>*@
                        </div>
                            </div>


                    <div class="col-md-6 details1" id="divCostUpdate">
                        <div class="">
                            <div class="col-md-12">
                                <h3 class="card-title mb-3 mt-2">Cost Updation <span id="h2ratetype" style="color:blue" class="ml-10">@Model.CustomerRateType</span></h3><hr />
                            </div>

                            <div class="row">
                                @Html.HiddenFor(model => model.CustomerRateType, new { @class = "form-control", @autocomplete = "off", @readonly = "readonly" })
                                @Html.HiddenFor(model => model.CustomerRateTypeID)

                                <div class="col-md-4">
                                    <div class="mb-2">
                                        <label class="col-form-label required">Cr.Chg</label>
                                        @Html.TextBoxFor(model => model.CourierCharge, new { @class = "form-control textright", @onchange = "setTwoNumberDecimal(this)", @required = "true", @type = "number", @step = "0.01", @min = 1 })
                                        <div class="invalid-feedback">
                                            Courier Charge Required
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-2">
                                        <div class="flex">
                                            <div class="input-group">
                                                <label class="col-form-label">Oth.Chg</label>
                                                <div class="input-group-sm mt-16 masterplus Allocate" id="divothercharge">
                                                    <i class="mdi  mdi-plus" aria-hidden="true"></i>
                                                </div>
                                            </div>
                                        </div>
                                        @Html.TextBoxFor(model => model.OtherCharge, new { @class = "form-control textright", @onkeypress = "return isNumberKey(event)", @onchange = "setTwoNumberDecimal(this)", @readonly = "readonly" })
                                        @*<input type="button" style="float:right" value="O" onclick="ShowOtherChargesModal()" />*@
                                    </div>
                                </div>
                                @*<div class="col-md-1">
            <label class="col-form-label">Add Other Charge</label>
        </div>*@
                                <div class="col-md-4">
                                    <div class="mb-2">
                                        <div class="flexTitle">
                                            @*<label class="col-form-label red" id="lblTaxPercent">Tax + @Model.TaxPercent %</label>*@
                                            <div class="checkboxdesign no-padding text-right" style="float:left;">
                                                @Html.CheckBox("ChkTaxPercent", new { @name = "ChkTaxPercent", @onchange = "CalculateTax()" }) &nbsp
                                                <label class="col-form-label" style="color:#07a7e3!important;padding-left: 0!important">Tax + @Model.TaxPercent %</label>
                                            </div>
                                        </div>
                                        @Html.TextBoxFor(model => model.TaxAmount, new { @class = "form-control text-right", @autocomplete = "off", @readonly = "true" })
                                        @Html.HiddenFor(mode => Model.TaxPercent)
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-2">
                                        <div class="flexTitle">
                                            <div class="checkboxdesign no-padding text-right" style="float:left;">
                                                @Html.CheckBox("ChkSurcharge", new { @name = "ChkSurcharge", @onchange = "SetSurcharge()" }) &nbsp
                                                <label class="col-form-label" style="color:#07a7e3!important;padding-left: 0!important">S.chg %</label>
                                            </div>
                                        </div>
                                        @Html.TextBoxFor(model => model.SurchargePercent, new { @class = "form-control text-right", @autocomplete = "off", @readonly = "readonly" ,onchange="CalculateTax()" })
                                        @Html.HiddenFor(mode => Model.DefaultSurchargePercent)
                                        @Html.HiddenFor(mode => Model.SurchargeAmount)
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-2">
                                        <label class="col-form-label">Mat.Cost</label>
                                        @Html.TextBoxFor(model => model.materialcost, new { @class = "form-control txtright textright", @onkeypress = "return isNumberKey(event)", @onchange = "setTwoNumberDecimal(this)" })
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="mb-2">
                                        <label class="col-form-label">Total</label>
                                        @Html.TextBoxFor(model => model.totalCharge, new { @class = "form-control textright", @onchange = "setTwoNumberDecimal(this)", @readonly = "readonly" })
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <h3 class="card-title mb-3 mt-2">Shipper Instructions</h3><hr />
                                            <div class="mb-2 mt-4">
                                                <div class="row">
                                                    <div class="col-md-5 mt-2">
                                                        @Html.CheckBox("IsNCND", new { @name = "IsNCND" })

                                                        <label class="col-form-label">NCND</label>
                                                    </div>
                                                    <div class="col-md-7 mt-2">
                                                        @Html.CheckBox("IsCashOnly", new { @name = "IsCashOnly" })

                                                        <label class="col-form-label">Cash Only</label>
                                                    </div>
                                                </div>
                                                <div>
                                                    @Html.CheckBox("IsChequeOnly", new { @name = "IsChequeOnly" })

                                                    <label class="col-form-label">Cheque Only</label>
                                                </div>

                                                <div>
                                                    @Html.CheckBox("IsCollectMaterial", new { @name = "IsCollectMaterial" })

                                                    <label class="col-form-label">Collect Material</label>
                                                </div>
                                                <div>
                                                    @Html.CheckBox("IsDOCopyBack", new { @name = "IsDOCopyBack" })

                                                    <label class="col-form-label">DOCopyBack</label>
                                                </div>
                                            </div>


                                        </div>
                                        <div class="col-md-4">
                                            <h3 class="card-title mb-3 mt-2">Courier Details</h3><hr />
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="mb-2">
                                                        <label class="col-form-label">Picked By</label>
                                                        @Html.DropDownListFor(model => model.PickedBy, new SelectList(@ViewBag.Employee, "EmployeeID", "EmployeeName"), "Select", new { @class = "form-select select_red", @disabled = "disabled" })
                                                    </div>
                                                </div>

                                                <div class="col-md-12">
                                                    <div class="mb-2">
                                                        <label class="col-form-label">Received By</label>
                                                        @Html.DropDownListFor(model => model.ReceivedBy, new SelectList(@ViewBag.Employee, "EmployeeID", "EmployeeName"), "Select", new { @class = "form-select", @disabled = "disabled" })
                                                    </div>
                                                </div>

                                            </div>

                                        </div>
                                        <div class="col-md-4">

                                            <h3 class="card-title mb-3 mt-2">Audit Details</h3><hr />
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="mb-2">
                                                        <label class="col-form-label">Created By  </label>
                                                        <input type="text" class="form-control" value="@Model.CreatedByName | @Model.CreatedByDate" readonly />

                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="mb-2">
                                                        <label class="col-form-label"> Modified By    </label>
                                                        <input type="text" class="form-control" value="@Model.LastModifiedByName | @Model.LastModifiedDate" readonly />
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>

                               

                            </div>
                        </div>
                    </div>




                </div>



            </div>
            <style>
                .form-control {
                    color: #178bd1 !important;
                }
            </style>


        </div>
    </div>






    <div style="width:100%;height:3000px; color:black;opacity:0.6;z-index:5;display:none;background-color: black;position:absolute;top:0;left:0;" id="popupbackground">


    </div>


    <div class="modal fade" id="popup" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">

        <div class="modal-dialog modal-dialog-centered">

            <div class="modal-content" style="border-radius:5px;width:700px">


                <div class="modal-header">
                    <h4 class="modal-title">
                        Other Charges
                    </h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

                </div>


                <div class="modal-body">

                    <div class="container-fluid">

                        <div class="row">


                            <input type="hidden" value="@Model.otherchargesVM.Count" id="RowCount" />

                            <table id="ExpAllocationTable" class="table table-bordered table-responsive">

                                <thead>

                                    <tr>

                                        <th>Other Charge</th>

                                        <th>Amount </th>

                                        <th>Delete </th>

                                    </tr>

                                </thead>

                                <tbody id="OtherChargeTable">
                                    @foreach (var item in Model.otherchargesVM)
                                    {
                                        <tr>
                                            <td>
                                                @item.OtherChargeName
                                                <input type="hidden" class="OChargeID" name="otherchargesVM[@otherchargecount].OtherChargeID" value="@item.OtherChargeID" id="OtherCharge_@otherchargecount" />
                                                <input type="hidden" class="hdndeleted" name="otherchargesVM[@otherchargecount].Deleted" id="hdndeleted_@otherchargecount" value="@item.Deleted" />
                                            </td>
                                            <td style="text-align:right">
                                                @Net4Courier.Models.CommonFunctions.GetDecimalFormat(@item.Amount, "2")
                                                <input type="hidden" id="Amount_@otherchargecount" name="otherchargesVM[@otherchargecount].Amount" class="ExpAllocatedAmountDetails" value="@item.Amount" />
                                            </td>
                                            <td style="text-align: center;">

                                                <a href="javascript:void(0)" onclick="deleteOthertrans(this)"><i class="mdi mdi-delete font-size-18"></i></a>

                                            </td>
                                        </tr>
                                        otherchargecount++;
                                    }
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <td>
                                            @Html.DropDownList("OtherChargeID", new SelectList(@ViewBag.OtherCharge, "OtherChargeID", "OtherCharge1"), "Select", new { @class = "form-select" })
                                            <input type="hidden" id="OtherChargeAcHeadID" value="" class="form-control" autocomplete="off" />
                                        </td>
                                        <td>
                                            <input type="text" class="text-right form-control txtNum" id="ExpAmount" value="0" />
                                        </td>
                                        <td style="text-align:center;">
                                            <button type="button" style="height: 25px !important;margin-top:2px;border:0;    background: #35b8eb;color:#fff; vertical-align: middle;" index="1" id="AddExpAllocation" class="addmore">+</button>&nbsp;&nbsp;
                                            @*<button type="button" style="height: 25px !important;margin-top:14px; vertical-align: middle;border:none" id="AllocationClose"><i style="font-size:21px" class="fa fa-times"></i></button>*@
                                        </td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="padding-top: 5px">
                    <span class="error text-left" id="spanotherchargeerror"></span>
                    <button type="button" id="AllocationClose" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade bs-example-modal-lg" id="itempopup" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">

        
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content" style="border-radius:5px;">



                    <div class="modal-header">
                        <h4 class="modal-title">Shipment Items</h4>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>

                    <div class="modal-body">

                        <div class="container-fluid">

                            <div class="row">
                                <input type="hidden" value="@Model.shipmentItemVM.Count" id="ItemRowCount" />
                                <table id="ItemTable" class="table table-bordered table-responsive">

                                    <thead>

                                        <tr>

                                            <th>Box</th>
                                            <th>Contents</th>
                                            <th>Qty</th>
                                            <th>Weight per Carton(KG) </th>
                                            <th>Total Weight (KG) </th>
                                            <th>Value</th>
                                            <th>Delete </th>

                                        </tr>

                                    </thead>

                                    <tbody id="ItemBody">
                                        @foreach (var item in Model.shipmentItemVM)
                                        {
                                            <tr>
                                                <td>
                                                    @item.BoxName
                                                    <input type="hidden" class="OShipmentId" name="shipmentItemVM[@itemcount].ID" value="@item.ID" id="ShipmentItem_@itemcount" />
                                                    <input type="hidden" name="shipmentItemVM[@itemcount].BoxName" value="@item.BoxName" id="ItemBoxName_@itemcount" />
                                                    <input type="hidden" class="hdndeleted" name="shipmentItemVM[@itemcount].Deleted" id="hdnItemdeleted_@itemcount" value="@item.Deleted" />
                                                </td>
                                                <td>
                                                    <input type="hidden" name="shipmentItemVM[@itemcount].Contents" value="@item.Contents" id="ItemContents_@itemcount" />
                                                    @item.Contents
                                                </td>
                                                <td style="text-align:right">
                                                    @Net4Courier.Models.CommonFunctions.GetDecimalFormat(@item.Qty, "2")
                                                    <input type="hidden" id="ItemQty_@itemcount" name="shipmentItemVM[@itemcount].Qty" class="ExpAllocatedAmountDetails" value="@item.Qty" />
                                                </td>
                                                <td style="text-align:right">
                                                    @Net4Courier.Models.CommonFunctions.GetDecimalFormat(@item.WeightPerCarton, "3")
                                                    <input type="hidden" id="ItemWeight_@itemcount" name="shipmentItemVM[@itemcount].WeightPerCarton" class="ExpAllocatedAmountDetails" value="@item.WeightPerCarton" />
                                                </td>
                                                <td style="text-align:right">
                                                    @Net4Courier.Models.CommonFunctions.GetDecimalFormat(@item.TotalWeight, "2")
                                                    <input type="hidden" id="ItemTotalWeight_@itemcount" name="shipmentItemVM[@itemcount].TotalWeight" class="ExpAllocatedAmountDetails" value="@item.TotalWeight" />
                                                </td>
                                                <td style="text-align:right">
                                                    @Net4Courier.Models.CommonFunctions.GetDecimalFormat(@item.Value, "2")
                                                    <input type="hidden" id="ItemValue_@itemcount" name="shipmentItemVM[@itemcount].Value" class="ExpAllocatedAmountDetails" value="@item.Value" />
                                                </td>
                                                <td style="text-align: center;">

                                                    <a href="javascript:void(0)" onclick="deleteItemtrans(this)"><i class="fa fa-times"></i></a>

                                                </td>
                                            </tr>
                                            itemcount++;
                                        }
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <td>
                                                <input type="text" id="BoxName" value="" class="form-control" autocomplete="off" />
                                                <input type="hidden" id="ItemID" value="" class="form-control" autocomplete="off" />
                                            </td>
                                            <td>
                                                <input type="text" id="ItemContents" value="" class="form-control" autocomplete="off" />
                                            </td>
                                            <td>
                                                <input type="text" class="textright0 form-control txtNum" id="ItemQty" onchange="calcitemtotalweight()" value="" />
                                            </td>
                                            <td>
                                                <input type="text" class="textright3 form-control txtNum" id="ItemWeight" onchange="calcitemtotalweight()" value="" />
                                            </td>
                                            <td>
                                                <input type="text" class="textright3 form-control txtNum" id="ItemTotalWeight" value="" />
                                            </td>
                                            <td>
                                                <input type="text" class="textright form-control txtNum" id="ItemValue" value="" />
                                            </td>
                                            <td style="text-align:center;">
                                                <button type="button" style="height: 25px !important;margin-top:2px;border:0;    background: #35b8eb;color:#fff; vertical-align: middle;" index="1" id="AddItem" class="addmore"><i class="mdi mdi-plus font-size-18"></i></button>&nbsp;&nbsp;

                                            </td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer" style="padding-top: 5px">
                        <label id="lbltotalweight" style="color:red"></label>
                        <button type="button" id="ItemClose" class="btn btn-secondary"  data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

}

<div class="modal fade" id="StatusModal" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content" style="border-radius: 5px;">
            <div class="modal-header" style="background-color: #f5f5f5;">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="exampleModalLabel">
                    Change Status
                </h4>
            </div>

            <div class="modal-body">
                <div class="container-fluid">
                    <div class="row" style="padding-top: 5px">
                        <div class="col-sm-12">
                            <div class="row">
                                <div class="col-xs-5 col-sm-3">
                                    Shipment Status
                                </div>
                                <div class="col-xs-7 col-sm-9">
                                    @Html.DropDownList("StatusTypeId", new SelectList(@ViewBag.StatusTypeList, "ID", "Name", 0), "Select", new { @class = "form-control", @id = "ChangeStatusTypeId", @name = "ChangeStatusTypeId" })
                                </div>
                            </div>
                            <div class="row" style="margin-top:10px">
                                <div class="col-xs-5 col-sm-3">
                                    Courier Status
                                </div>
                                <div class="col-xs-7 col-sm-9">
                                    @Html.DropDownList("CourierStatusId", new SelectList(@ViewBag.CourierStatusList, "CourierStatusID", "CourierStatus", @ViewBag.CourierStatusId), "Select", new { @class = "form-control", @id = "ChangeCourierStatusId", @name = "ChangeCourierStatusId" })
                                    @*<input type="text" id="ChangeCourierStatusId" class="form-control" value="2" width="100%" />*@
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="padding-top: 5px">
                <input type="hidden" id="hdnCountryID" />
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" name="Command" value="SaveStatus" class="btn btn-primary" id="btnsavestatus">Save</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="CustomerNotifiyModal" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #f5f5f5;">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="exampleModalLabel">
                    Customer Notification
                </h4>
            </div>

            <div class="modal-body">
                <div class="container-fluid">
                    <div class="row" style="padding-top: 5px">
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-xs-5 col-sm-3">
                                    To Customer
                                </div>
                                <div class="col-xs-7 col-sm-9">
                                    <input type="hidden" id="hdnNotificationId" value="0" />
                                    <input class="form-control" type="text" id="txtcustomername" />
                                </div>
                            </div>
                            <div class="row" style="margin-top:10px;">
                                <div class="col-xs-5 col-sm-3">
                                    Customer Email
                                </div>
                                <div class="col-xs-7 col-sm-9">
                                    <input class="form-control" type="text" id="txtcustomeremail" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4 checkboxdesign">
                                    @Html.CheckBox("SMS", new { @name = "SMS" })
                                    <label class="headinglabel">SMS</label>
                                </div>
                                <div class="col-md-4 checkboxdesign">
                                    @Html.CheckBox("Email", new { @name = "Email" })
                                    <label class="headinglabel">Email</label>
                                </div>
                                <div class="col-md-4 checkboxdesign">
                                    @Html.CheckBox("WhatsApp", new { @name = "WhatsApp" })
                                    <label class="headinglabel">Whats App</label>
                                </div>
                            </div>
                            <div class="row" style="margin-top:10px">
                                <div class="col-xs-5 col-sm-3">
                                    Enter your Message
                                </div>
                                <div class="col-xs-7 col-sm-9">
                                    <textarea id="notifymessage" cols="65" rows="5"></textarea>
                                </div>
                            </div>
                            <div class="row no-margin" style="padding-top:10px">

                                <div class="col-md-12">
                                    <table id="notificationdetails" class="table table-responsive table-bordered" style="background-color:white">
                                        <thead>
                                        <th>S No.</th>
                                        <th>Message</th>
                                        <th>Date</th>
                                        <th>Employee Name</th>
                                        </thead>
                                        <tbody id="notificationdetailsbody"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="padding-top: 5px">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" name="Command" value="SaveStatus" class="btn btn-primary" id="btncustomernotifysave" onclick="savecustomernotification();">Save</button>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="StaffNotesModal" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #f5f5f5;">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="exampleModalLabel">
                    Staff Notes
                </h4>
            </div>

            <div class="modal-body">
                <div class="container-fluid">
                    <div class="row" style="padding-top: 5px">
                        <div class="col-sm-12">
                            <div class="row" style="margin-top:10px">
                                <div class="col-xs-12 col-sm-12">
                                    <input type="hidden" id="hdnStaffNotesId" value="0" />
                                    <label for="staffnotes" class="control-label">Enter your Notes</label>
                                    <textarea id="staffnotes" class="col-md-12" cols="65" rows="5"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row no-margin" style="padding-top:10px">

                        <div class="col-md-12">
                            <table id="notesdetails" class="table table-responsive table-bordered" style="background-color:white">
                                <thead>
                                <th>S No.</th>
                                <th>Notes</th>
                                <th>Date</th>
                                <th>Employee Name</th>
                                </thead>
                                <tbody id="notesdetailsbody"></tbody>
                            </table>
                        </div>
                    </div>

                </div>
            </div>
            <div class="modal-footer" style="padding-top: 5px">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" name="Command" value="SaveNotes" class="btn btn-primary" id="btnstaffnotessave" onclick="savestaffnotes()">Save</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="customerpopup" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="border-radius:5px;min-width:600px">
            <div class="modal-header">
               
                <h4 class="modal-title">
                    Customer Entry
                </h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <div class="modal-body">
                <div class="container-fluid" id="customerContainer">

                </div>
            </div>
            <div class="modal-footer" style="padding-top: 5px">
                <button type="button" class="btn btn-primary" onclick="SaveCustomerEntry()">Save</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="Locationpopup" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content " style="border-radius:5px">

            <div class="modal-header">
                <h4 class="modal-title">
                    Location Entry
                </h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

            </div>

            <div class="modal-body">
                <div class="container-fluid" id="LocationContainer">

                </div>
            </div>
            <div class="modal-footer" style="padding-top: 5px">
                <button type="button" class="btn btn-success" onclick="SaveLocationEntry()">Save</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="AddImportAWBpopup" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content" style="border-radius:5px">

            <div class="modal-header">
                <h4 class="modal-title">
                    Import Shipment Reference
                </h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

            </div>

            <div class="modal-body">
                <div class="container-fluid" id="ImportAWBContainer">
                    <div class="row">
                        <div class="col-md-4">
                            <lable>Import AWB Reference </lable>
                            <input type="hidden" id="txtImportInscanID" value="" class="form-control" />
                            <input type="text" id="txtImportAWBNo" value="" class="form-control" />
                        </div>
                        <div class="col-md-2" style="padding-top:0px">
                            <button type="button" class="btn btn-primary" style="margin-top:17px!important" onclick="CheckImportAWBReference()">Search</button>
                        </div>
                        <div class="col-md-6">
                            <lable>AWB Date</lable>
                            <input type="text" id="txtImportAWBDate" value="" class="form-control" readonly />
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <lable>Consignor</lable>
                            <input type="text" id="txtImportAWBConsignor" value="" class="form-control" readonly />
                        </div>
                        <div class="col-md-6">
                            <lable>Consignee</lable>
                            <input type="text" id="txtImportAWBConsignee" value="" class="form-control" readonly />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <lable>Consignor Country</lable>
                            <input type="text" id="txtImportAWBConsignorCountry" value="" class="form-control" readonly />
                        </div>
                        <div class="col-md-6">
                            <lable>Consignee Country</lable>
                            <input type="text" id="txtImportAWBConsigneeCountry" value="" class="form-control" readonly />
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="padding-top: 5px">
                <button type="button" class="btn btn-warning " style="float:left;margin-left:15px;" onclick="RemoveImportAWBReference()">Remove</button>
                <button type="button" class="btn btn-primary" onclick="SaveImportAWBReference()">Select</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>




    </section>
<script>
    function RestrictSpaceSpecial1(e) {
        var k;
        document.all ? k = e.keyCode : k = e.which;
        console.log(e.keyCode);
        if ((k >= 48 && k <= 57))
            return true;
        else
            return false;
        //return ((k > 64 && k < 91) || (k > 96 && k < 123) || k == 8 || k == 32 || (k >= 48 && k <= 57));
    }
    function RestrictSpaceSpecial(e) {
        var k;
        document.all ? k = e.keyCode : k = e.which;
        //console.log(e.keyCode);
        if ((k >= 48 && k <= 57) || k == 46)
            return true;
        else
            return false;
        //return ((k > 64 && k < 91) || (k > 96 && k < 123) || k == 8 || k == 32 || (k >= 48 && k <= 57));
    }
    function calcitemtotalweight() {
        var weight = $('#ItemWeight').val();
        var qty = $('#ItemQty').val();
        if (qty == null || qty == '')
            qty = 0;
        if (weight == null || weight == '')
            weight = 0;
        var totalweight = parseFloat(weight) * parseFloat(qty);
        $('#ItemTotalWeight').val(parseFloat(totalweight).toFixed(3));
    }
    function getTotalweight() {
        debugger;
        var maxrow = $('#ItemBody > tr').length;
        var totalweight = 0;
        var totalpcs = 0;
        $('#Weight').val(totalweight);
        $('#Pieces').val(0);
        for (i = 0; i < maxrow; i++) {
            var deleted = $('#hdnItemdeleted_' + i).val();
            if (deleted == 'false' || deleted == '' || deleted == null) {
                var otherweight = $('#ItemTotalWeight_' + i).val();
                var otherqty = $('#ItemQty_' + i).val();
                totalweight = parseFloat(totalweight) + parseFloat(otherweight);
                if (parseFloat(otherweight) > 0)
                    totalpcs = parseFloat(totalpcs) + parseFloat(otherqty);

                $('#Pieces').val(parseFloat(totalpcs).toFixed(0));
                $('#Weight').val(parseFloat(totalweight).toFixed(3));
                $('#lbltotalweight').html('Total Piecs :' + parseFloat(totalpcs) + '  ' + 'Total Weight: ' + parseFloat(totalweight).toFixed(3));
            }
        }
    }
    $(document).ready(function () {

     

    });
</script>
<script type="text/javascript">
      
                                $(document).ready(function () {

                                 
                                    $('.txtNum').blur(function () {
                                        if (isNaN(parseInt($(this).val()))) {
                                            $(this).val('0.00');
                                        } else {
                                            var amt = parseFloat($(this).val());
                                            $(this).val(amt.toFixed(2));
                                        }
                                    });

                                   
                                });
                                function ClearData() {
                                    $("#ReceivedFrom").val('');
                                    $("#SelectedReceivedFrom").val(0);
                                    $("#amount").val('');
                                    $("#remark1").val('');
                                    $("#AcHeadAllocation").val('');
                                    $("#SelectedAcHeadAllocation").val(0);
                                    $("#ExpAmount").val('');
                                    $("#ExpAllocationTable").find("tr:gt(0)").remove();
                                }
</script>

@section scripts{



    <script src="~/Scripts/JS/AWBCreate.js?v=1"></script>


}
