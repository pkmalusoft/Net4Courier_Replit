@model Net4Courier.Models.HoldVM

@{
    
    Layout = "~/Views/Shared/_Layout.cshtml";
}


@*<script type="text/javascript">
    $(function () {
        $('#EntryDate').datetimepicker({ format: 'DD-MM-YYYY HH:mm' });
    });

</script>*@
<script type="text/javascript">
    $(document).ready(function () {

        $(":text").css({ "border-radius": "5px" });
        $("select").css({ "border-radius": "5px" });
         var startdate = '@Session["FyearFrom"].ToString()';
        var enddate = '@Session["FyearTo"].ToString()';
        var sd = new Date(startdate.split('-')[1] + '-' + startdate.split('-')[0] + '-' + startdate.split('-')[2]);
        var ed = new Date(enddate.split('-')[1] + '-' + enddate.split('-')[0] + '-' + enddate.split('-')[2]);

        $(function () {
            $('#EntryDate').datetimepicker({
                maxDate: ed,
                minDate: sd,
                format: 'DD-MM-YYYY HH:mm',
            });

        });
        var m_names = new Array("Jan", "Feb", "Mar",
            "Apr", "May", "Jun", "Jul", "Aug", "Sep",
            "Oct", "Nov", "Dec");

        var d = new Date();
        var curr_date = d.getDate();
        var curr_month = d.getMonth() + 1;
        var curr_year = d.getFullYear();

        var reqdate = curr_date + "-" + curr_month + "-" + curr_year + ' ' + d.getHours() + ':' + d.getMinutes();
        if ($('#HoldReleaseID').val() > 0) {
            $("#AWBNo").attr("readonly", "readonly");
            $("#EntryDate").attr("readonly", "readonly");
        }
        else {

        }

        $('#AWBNo').focus();
        $("#AWBNo").change(function () {
            var id = $("#AWBNo").val();
            $.ajax({
                type: "POST",
                url: "/Hold/GetAWBData",
                datatype: "Json",
                data: { id: id },
                success: function (response) {
                    if (response.status == "ok") {
                        debugger;
                        var data = response.data;
                        console.log(data);
                        $("#InScanID").val(data.InScanID);
                        $('#ShipmentDetailID').val(data.ShipmentDetailID);
                        var myDate = new Date(data.AWBDate.match(/\d+/)[0] * 1);
                        var cmon = myDate.getMonth() + 1;
                        var collectdate = myDate.getDate() + "-" + cmon + "-" + myDate.getFullYear(); // + ' ' + myDate.getHours() + ':' + myDate.getMinutes();
                        $('#AWBDate').val(collectdate);
                        $("#Consignor").val(data.Consignor);
                        $("#Consignee").val(data.Consignee);
                        $("#Pieces").val(data.Pieces);
                        $("#Weight").val(data.Weight);
                        $("#CourierCharges").val(data.CourierCharges);
                        $("#OriginCountry").val(data.OriginCountry);
                        $("#ConsigneeCountry").val(data.ConsigneeCountry);
                        $("#StatusPaymentMOde").val(data.StatusPaymentMOde);
                        $("#CollectedByName").val(data.CollectedByName);
                        $("#CourierStatus").val(data.CourierStatus);
                        $("#ActionType").val(data.ActionType);
                        $('#CourierStatusID').val(data.CourierStatusID);

                       $.ajax({
                             type: 'POST',
                             url: '@Url.Action("ShowItemList", "Hold")',
                             datatype: "html",
                             success: function (data) {
                                 $("#listContainer").html(data);

                             },
                             error: function (err) {
                                 console.log(err);
                             }
                         });



                    }
                    else {
                        $("#InScanID").val(0);
                        $('#AWBNo').val('');
                        $('#AWBNo').focus();
                        $.notify(response.message, "error");
                        //alert(response.message);
                    }

                }
            });


        })

    });

</script>

    @using (Html.BeginForm())
    {
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true)
        <div id="validations" style="color:red;margin-left:7px;display:none">* Please fill mandatory fields</div>
        <fieldset>

            <div class="card">
                <div class="card-body">   
                    <div class="row">
                        <div class="col-md-12 text-md-end mb-1">
                            <input type="submit" value="Save" class="btn btn-success" id="btnsave" />
                            <a href='@Url.Action("Index", "Hold", new { id = 0 })' class="btn btn-secondary">Cancel</a>
                        </div>             
                        <div class="col-md-2">
                            <div class="mb-2">
                                @Html.HiddenFor(model => model.InScanID)
                                @Html.HiddenFor(model => model.HoldReleaseID)
                                @Html.HiddenFor(model => model.ShipmentDetailID)
                                @Html.HiddenFor(model => model.CourierStatusID)
                                @Html.HiddenFor(model => model.Action)
                                <label class="col-form-label required">AWB No.</label>
                                @Html.TextBoxFor(model => model.AWBNo, new { @class = "form-control", @required = "true" })
                                @Html.ValidationMessageFor(model => model.AWBNo)
                            </div>
                        </div>
                        <div class="col-md-2">
                        <div class="mb-2">
                            <label class="col-form-label required">Entered By</label>                    
                            @Html.DropDownListFor(model => model.EmployeeID, new SelectList(ViewBag.HeldBy, "EmployeeID", "EmployeeName"), "Select", new { @class = "form-select", @required = "true" })
                            @Html.ValidationMessageFor(model => model.EmployeeID)
                        </div>
                        </div>
                        
                        <div class="col-md-2">
                            <div class="mb-2">
                                <label class="col-form-label">Entry Date</label>
                                <div class="docs-datepicker">
                                    <div class="input-group">
                                        <input type="text" class="form-control docs-date" name="EntryDate" id="EntryDate" data-date-format="dd/MM/yyyy" data-date-autoclose="true" data-provide="datepicker" value="@Model.EntryDate.ToShortDateString()"
                                            placeholder="Pick a date" autocomplete="off">
                                        <button type="button"
                                                class="btn btn-secondary docs-datepicker-trigger"
                                                disabled>
                                            <i class="mdi mdi-calendar" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                    <div class="docs-datepicker-container"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                        <div class="mb-2">
                            <label class="col-form-label required">Reason</label>
                            @Html.TextBoxFor(model => model.Remarks, new { @class = "form-control", @required = "true" })
                            @Html.ValidationMessageFor(model => model.Remarks)
                        </div>
                        </div>
                        <div class="col-md-2">
                        <div class="mb-2">
                            <label class="col-form-label required">Courier Status</label>
                            @Html.TextBoxFor(model => model.CourierStatus, new { @class = "form-control", @required = "true",@readonly="readonly" })
                            @Html.ValidationMessageFor(model => model.CourierStatus)
                        </div>
                        </div>
                        <div class="col-md-1">
                        <div class="mb-2">
                            <label class="col-form-label required">Action</label>
                            @Html.TextBoxFor(model => model.ActionType, new { @class = "form-control", @required = "true", @readonly = "readonly" })
                            @Html.ValidationMessageFor(model => model.ActionType)
                        </div>
                        </div>
                       
                    </div>
                </div>
            </div>
             <div class="card">
                <div class="card-body">   
                    <div class="row no-margin">
                        <div class="col-md-12">
                            <h4>AWB DETAILS</h4><hr />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-2">
                            <div class="mb-2">
                                <label class="col-form-label">AWB Date</label>
                                <div class="docs-datepicker">
                                    <div class="input-group">
                                        <input type="text" class="form-control docs-date" name="AWBDate" id="AWBDate" data-date-format="dd/MM/yyyy" data-date-autoclose="true" data-provide="datepicker" value="@Model.AWBDate.ToShortDateString()"
                                            placeholder="Pick a date" autocomplete="off">
                                        <button type="button"
                                                class="btn btn-secondary docs-datepicker-trigger"
                                                disabled>
                                            <i class="mdi mdi-calendar" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                    <div class="docs-datepicker-container"></div>
                                </div>
                            </div>
                        </div>
                       
                        <div class="col-md-2">
                            <label class="col-form-label">Collected By</label>
                            @Html.TextBoxFor(model => model.CollectedByName, new { @class = "form-control", @readonly = "readonly" })
                            @Html.ValidationMessageFor(model => model.CollectedByName)
                        </div>

                        <div class="col-md-2">
                            <label class="col-form-label">Payment Mode</label>
                            @Html.TextBoxFor(model => model.StatusPaymentMOde, new { @class = "form-control", @readonly = "readonly" })
                            @Html.ValidationMessageFor(model => model.StatusPaymentMOde)

                        </div>
                        <div class="col-md-2">
                            <label class="col-form-label">Weight</label>
                            @Html.TextBoxFor(model => model.Weight, new { @class = "form-control text-right", @readonly = "readonly" })
                            @Html.ValidationMessageFor(model => model.Weight)

                        </div>

                        <div class="col-md-2">
                            <label class="col-form-label">Pieces</label>
                            @Html.TextBoxFor(model => model.Pieces, new { @class = "form-control text-right", @readonly = "readonly" })
                            @Html.ValidationMessageFor(model => model.Pieces)
                        </div>
                        <div class="col-md-2">
                            <label class="col-form-label">Courier Charges</label>
                            @Html.TextBoxFor(model => model.CourierCharges, new { @class = "form-control text-right", @readonly = "readonly" })
                            @Html.ValidationMessageFor(model => model.CourierCharges)
                        </div>
                    </div>
                    <div class="row no-margin" style="padding-top:10px;">

                        <div class="col-md-3">
                            <label class="col-form-label">Shipper</label>
                            @Html.TextBoxFor(model => model.Consignor, new { @class = "form-control", @readonly = "readonly" })
                            @Html.ValidationMessageFor(model => model.Consignor)
                        </div>

                        <div class="col-md-3">
                            @Html.HiddenFor(model => model.OriginID)
                            <label class="col-form-label">Origin</label>
                            @Html.TextBoxFor(model => model.OriginCountry, new { @class = "form-control txttarget", @readonly = "readonly" })
                            @Html.ValidationMessageFor(model => model.OriginCountry)
                        </div>
                        <div class="col-md-3">
                            <label class="col-form-label">Consignee</label>
                            @Html.TextBoxFor(model => model.Consignee, new { @class = "form-control txttarget", @readonly = "readonly" })
                            @Html.ValidationMessageFor(model => model.Consignee)
                        </div>
                        <div class="col-md-3">
                            @Html.HiddenFor(model => model.DestinationID)
                            <label class="col-form-label">Destination</label>
                            @Html.TextBoxFor(model => model.ConsigneeCountry, new { @class = "form-control txttarget", @readonly = "readonly" })
                            @Html.ValidationMessageFor(model => model.ConsigneeCountry)
                        </div>
                    </div>
</div></div>
          
                
                <div class="card">
                    <div class="card-body">
                            <div class="col-md-12">
                                <h4>HISTORY DETAILS</h4><hr />
                            </div>
                  
                        @{Html.RenderPartial("ItemList", Model);}
                    </div>
         </div>
 </fieldset>

    }



