@page "/cash-bank"
@inject NavigationManager NavigationManager
@inject ApplicationDbContext DbContext
@inject IDialogService DialogService
@inject ISnackbar Snackbar
@using Microsoft.EntityFrameworkCore
@using Net4Courier.Infrastructure.Data
@using Net4Courier.Finance.Entities

<PageTitle>Cash and Bank - Net4Courier</PageTitle>

<MudContainer MaxWidth="MaxWidth.ExtraLarge" Class="mt-4">
    <MudPaper Class="pa-4" Elevation="2">
        <MudTabs @bind-ActivePanelIndex="_activeTabIndex" Elevation="0" Rounded="true" ApplyEffectsToContainer="true">
            <MudTabPanel Text="Cash Vouchers" Icon="@Icons.Material.Filled.Money">
                <VoucherList VoucherType="CV" VoucherTypeName="Cash" AccountNature="AccountNature.CashAccount" />
            </MudTabPanel>
            <MudTabPanel Text="Bank Vouchers" Icon="@Icons.Material.Filled.AccountBalance">
                <VoucherList VoucherType="BV" VoucherTypeName="Bank" AccountNature="AccountNature.BankAccount" />
            </MudTabPanel>
        </MudTabs>
    </MudPaper>
</MudContainer>

@code {
    private int _activeTabIndex;

    [SupplyParameterFromQuery(Name = "tab")]
    public string? TabParam { get; set; }

    protected override void OnInitialized()
    {
        if (!string.IsNullOrEmpty(TabParam))
        {
            _activeTabIndex = TabParam.ToLower() switch
            {
                "bank" => 1,
                _ => 0
            };
        }
    }
}
