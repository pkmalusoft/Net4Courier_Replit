Below is the **barcode scanning enhancement** to MAWB Processing, written as an **add-on specification** that cleanly integrates with the workflow you already defined.

---

## 12. Barcode Scanning for Shipment Addition (MAWB / Bagging)

### 12.1 Objective

Enable users to **add shipments to a MAWB by scanning the shipment barcode (AWB barcode)** instead of manual selection, improving speed, accuracy, and warehouse-floor usability.

---

## 13. Supported Scanning Modes

### 13.1 Desktop (Warehouse Counter)

* USB / Bluetooth barcode scanner (keyboard wedge mode)
* Cursor auto-focused on **Scan Input Field**
* Scanner inputs AWB number + Enter key

### 13.2 Mobile / Handheld (Future-ready)

* Camera-based barcode scan
* Dedicated scan button
* Real-time validation and feedback

---

## 14. Scan-Based Shipment Addition Workflow

### Step 1: MAWB Context Selection

User must first:

* Create or open a **Draft MAWB**
* Select:

  * Origin
  * Destination
  * Mode of Shipment
* Create at least **one Bag** (or system auto-creates a default bag)

> Scanning is **disabled** until MAWB context is ready.

---

### Step 2: Scan Shipment Barcode

* User scans AWB barcode
* System captures AWB number instantly
* No manual search or selection required

---

### Step 3: Real-Time System Validation

On each scan, system validates:

| Validation Rule                       | Action  |
| ------------------------------------- | ------- |
| AWB exists                            | Proceed |
| Origin & Destination match MAWB       | Proceed |
| Shipment not already bagged           | Proceed |
| Shipment not already assigned to MAWB | Proceed |
| Shipment status eligible              | Proceed |

If **any validation fails**, system:

* Rejects scan
* Shows clear error message
* Plays error beep (optional)

---

### Step 4: Auto Assignment to Bag

Based on configuration:

* **Option A (Default)**: Add shipment to currently active bag
* **Option B**: Prompt user to select bag
* **Option C**: Auto-create new bag when bag limit reached

System updates:

* Shipment → Bag Number
* Shipment → MAWB Number
* Shipment → Status = *Bagged*

---

## 15. User Interface – Scan Panel

### 15.1 Scan Input Section

* Scan textbox (hidden caret, auto-focus)
* Last scanned AWB display
* Scan counter (Shipments added)

### 15.2 Live Scan Log

Shows:

* AWB Number
* Bag Number
* Time scanned
* Status (Added / Rejected)

---

## 16. Error Handling & Messages (Examples)

| Scenario        | Message                                    |
| --------------- | ------------------------------------------ |
| AWB not found   | “Invalid AWB – Shipment does not exist”    |
| Already in MAWB | “Shipment already manifested”              |
| Route mismatch  | “Origin/Destination mismatch”              |
| Already bagged  | “Shipment already assigned to Bag {BagNo}” |

---

## 17. Status & Audit Impact

### Shipment Status Updates

* On successful scan:

  * Status → **Bagged**
  * MAWB Number assigned
  * Bag Number assigned

### Audit Log

* AWB scanned by (User ID)
* Scan timestamp
* Bag number
* MAWB number

---

## 18. Controls & Restrictions

* Duplicate scan of same AWB → Ignored with warning
* Remove shipment allowed **only before MAWB finalization**
* Scanning disabled once MAWB is **Finalized / Manifested**

---

## 19. Operational Advantages

* Faster warehouse operations
* Eliminates manual selection errors
* Ideal for peak-hour manifesting
* Aligns with real-world courier workflows

---

## 20. Optional Enhancements (Later Phase)

* Sound feedback (success / error)
* Auto-switch bag after N shipments
* Weight validation during scan
* Scan + seal workflow
* Offline scan queue (for mobile)

---

If you want, I can next:

* Extend this into **DB schema changes**
* Define **API endpoints for scan validation**
* Design **mobile scanning flow**
* Add **bag capacity logic**
* Integrate scanning into **shipment timeline & events**

Tell me which layer you want to proceed with next.
